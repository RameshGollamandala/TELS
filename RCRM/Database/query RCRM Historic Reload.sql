SELECT * FROM TELS_CONFIG;
UPDATE TELS_CONFIG SET DATE_VALUE = TO_DATE('09-MAR-2019', 'DD-MON-YYYY') WHERE ATTRIBUTE_NAME = 'RCRM PPE CUTOVER DATE';
--UPDATE TELS_CONFIG SET DATE_VALUE = TO_DATE('01-JAN-1900', 'DD-MON-YYYY') WHERE ATTRIBUTE_NAME = 'RCRM PPE CUTOVER DATE';

-- CLEAR OUT SOURCE TABLES

--
-- SQL #1
--

--SELECT *
DELETE
FROM TELS_RCRM_ROW_SOURCE
WHERE FILENAME in (
--  'CCB-RCRM_OrderDataExtract_20190201_055419.dat',
--  'CCB-RCRM_OrderDataExtract_20190202_045723.dat',
--  'CCB-RCRM_OrderDataExtract_20190203_051313.dat',
--  'CCB-RCRM_OrderDataExtract_20190204_052639.dat',
--  'CCB-RCRM_OrderDataExtract_20190205_060127.dat',
--  'CCB-RCRM_OrderDataExtract_20190206_055226.dat',
--  'CCB-RCRM_OrderDataExtract_20190207_060947.dat',
--  'CCB-RCRM_OrderDataExtract_20190208_053755.dat',
--  'CCB-RCRM_OrderDataExtract_20190209_053015.dat',
--  'CCB-RCRM_OrderDataExtract_20190210_050455.dat',
--  'CCB-RCRM_OrderDataExtract_20190211_050821.dat',
--  'CCB-RCRM_OrderDataExtract_20190212_055136.dat',
--  'CCB-RCRM_OrderDataExtract_20190213_053640.dat',
--  'CCB-RCRM_OrderDataExtract_20190214_033006.dat',
--  'CCB-RCRM_OrderDataExtract_20190215_033013.dat',
--  'CCB-RCRM_OrderDataExtract_20190216_033008.dat',
--  'CCB-RCRM_OrderDataExtract_20190217_102237.dat',
--  'CCB-RCRM_OrderDataExtract_20190218_033014.dat',
--  'CCB-RCRM_OrderDataExtract_20190219_033008.dat',
--  'CCB-RCRM_OrderDataExtract_20190220_033005.dat',
--  'CCB-RCRM_OrderDataExtract_20190221_033005.dat',
--  'CCB-RCRM_OrderDataExtract_20190222_033009.dat',
--  'CCB-RCRM_OrderDataExtract_20190223_073514.dat',
--  'CCB-RCRM_OrderDataExtract_20190224_033008.dat',
--  'CCB-RCRM_OrderDataExtract_20190225_033011.dat',
--  'CCB-RCRM_OrderDataExtract_20190226_033009.dat',
--  'CCB-RCRM_OrderDataExtract_20190227_211257.dat',
--  'CCB-RCRM_OrderDataExtract_20190228_033015.dat',
  'CCB-RCRM_OrderDataExtract_20190301_033020.dat', -- VALID FILE 01-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190302_033009.dat', -- INVALID FILE 02-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190303_033008.dat', -- VALID FILE 03-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190304_033007.dat', -- VALID FILE 04-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190305_033015.dat', -- VALID FILE 05-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190305_203431.dat', -- VALID FILE 02-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190306_033010.dat', -- VALID FILE 06-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190307_033009.dat', -- VALID FILE 07-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190308_033008.dat', -- VALID FILE 08-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190309_033005.dat', -- VALID FILE 09-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190310_033006.dat', -- VALID FILE 10-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190311_033013.dat', -- VALID FILE 11-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190312_033014.dat', -- VALID FILE 12-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190313_203431.dat' -- VALID FILE 13-MAR-2019
  )
;

--
-- SQL #2
--

--SELECT *
DELETE
FROM TELS_STAGE_RCRM_PPE
WHERE FILENAME in (
--  'CCB-RCRM_OrderDataExtract_20190201_055419.dat',
--  'CCB-RCRM_OrderDataExtract_20190202_045723.dat',
--  'CCB-RCRM_OrderDataExtract_20190203_051313.dat',
--  'CCB-RCRM_OrderDataExtract_20190204_052639.dat',
--  'CCB-RCRM_OrderDataExtract_20190205_060127.dat',
--  'CCB-RCRM_OrderDataExtract_20190206_055226.dat',
--  'CCB-RCRM_OrderDataExtract_20190207_060947.dat',
--  'CCB-RCRM_OrderDataExtract_20190208_053755.dat',
--  'CCB-RCRM_OrderDataExtract_20190209_053015.dat',
--  'CCB-RCRM_OrderDataExtract_20190210_050455.dat',
--  'CCB-RCRM_OrderDataExtract_20190211_050821.dat',
--  'CCB-RCRM_OrderDataExtract_20190212_055136.dat',
--  'CCB-RCRM_OrderDataExtract_20190213_053640.dat',
--  'CCB-RCRM_OrderDataExtract_20190214_033006.dat',
--  'CCB-RCRM_OrderDataExtract_20190215_033013.dat',
--  'CCB-RCRM_OrderDataExtract_20190216_033008.dat',
--  'CCB-RCRM_OrderDataExtract_20190217_102237.dat',
--  'CCB-RCRM_OrderDataExtract_20190218_033014.dat',
--  'CCB-RCRM_OrderDataExtract_20190219_033008.dat',
--  'CCB-RCRM_OrderDataExtract_20190220_033005.dat',
--  'CCB-RCRM_OrderDataExtract_20190221_033005.dat',
--  'CCB-RCRM_OrderDataExtract_20190222_033009.dat',
--  'CCB-RCRM_OrderDataExtract_20190223_073514.dat',
--  'CCB-RCRM_OrderDataExtract_20190224_033008.dat',
--  'CCB-RCRM_OrderDataExtract_20190225_033011.dat',
--  'CCB-RCRM_OrderDataExtract_20190226_033009.dat',
--  'CCB-RCRM_OrderDataExtract_20190227_211257.dat',
--  'CCB-RCRM_OrderDataExtract_20190228_033015.dat',
  'CCB-RCRM_OrderDataExtract_20190301_033020.dat', -- VALID FILE 01-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190302_033009.dat', -- INVALID FILE 02-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190303_033008.dat', -- VALID FILE 03-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190304_033007.dat', -- VALID FILE 04-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190305_033015.dat', -- VALID FILE 05-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190305_203431.dat', -- VALID FILE 02-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190306_033010.dat', -- VALID FILE 06-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190307_033009.dat', -- VALID FILE 07-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190308_033008.dat', -- VALID FILE 08-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190309_033005.dat', -- VALID FILE 09-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190310_033006.dat', -- VALID FILE 10-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190311_033013.dat', -- VALID FILE 11-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190312_033014.dat', -- VALID FILE 12-MAR-2019
  'CCB-RCRM_OrderDataExtract_20190313_203431.dat' -- VALID FILE 13-MAR-2019
  )
;

-- RELOAD OLD FILES

--
-- SQL #3
--

--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('01-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('02-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('03-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('04-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('05-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('06-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('07-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('08-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('09-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('10-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('11-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('12-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('13-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('14-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('15-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('16-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('17-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('18-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('19-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('20-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('21-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('22-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('23-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('24-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('25-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('26-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('27-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
--UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('28-FEB-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('01-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('02-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('03-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('04-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('05-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('06-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('07-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('08-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('09-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('10-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('11-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('12-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';
UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = TO_DATE('13-MAR-2019', 'DD-MON-YYYY'), OVERRIDE_TYPE = 'LANDING_DATE';

-- LOAD LIVE FILES

--
-- SQL #4
--

UPDATE TELS_PERIOD_OVERRIDE SET PERIOD_NAME = NULL, LANDING_DATE = NULL, OVERRIDE_TYPE = NULL;

--
-- SQL #5
--

SELECT PERIOD_NAME, TO_CHAR(LANDING_DATE,'DD-MON-YYYY') AS LANDING_DATE, OVERRIDE_TYPE FROM TELS_PERIOD_OVERRIDE;

