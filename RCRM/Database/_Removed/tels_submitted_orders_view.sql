DROP VIEW TELS_SUBMITTED_ORDERS_VIEW;

CREATE OR REPLACE FORCE VIEW TELS_SUBMITTED_ORDERS_VIEW
(
   REC_TYPE,
   FILENAME,
   BATCHPROCESSDATE,
   RECORDNUMBER,
   IS_FILTERED,
   ORDER_NUMBER,
   BILLING_ACCOUNT,
   CUSTOMER_LAST_NAME,
   CUSTOMER_FIRST_NAME,
   ORDER_TYPE,
   ORDER_SUB_TYPE,
   CREATED_DATE,
   PARTNER_CODE,
   CAMPAIGN_NAME,
   CAMPAIGN_NUMBER,
   CAMPAIGN_TYPE,
   CHANNEL_TYPE,
   CAMPAIGN_START_DATE,
   BUSINESS_UNIT,
   SALES_FORCE_ID,
   CUSTOMER_ID,
   ORDER_REVISION_NUMBER,
   SUBMITTED_DATE,
   STATUS_HEADER,
   REASON_CODE,
   COMMISSION_TRANSACTION_TYPE,
   SOURCE_SYSTEM,
   ROW_ID,
   PRODUCT,
   PART_NUMBER,
   ACTION_CODE,
   TRANSFER_TYPE,
   EVENT_SOURCE,
   PROD_PROM_ID,
   PROVISIONED_DATE,
   NET_PRICE,
   COMMISSION_PRODUCT_TYPE,
   COMMISSIONABLE,
   STATUS_ORDER_LINE_ITEM,
   ORIGINAL_ORDER_NUMBER,
   HARDWARE_SUPPLIED_FLAG,
   SUB_ACTION_CODE,
   PROMOTION_INTEGRATION_ID,
   NGB_PROD_TYPE,
   PROMOTION_PART_NUMBER,
   PRODUCT_ID,
   O2A_STATUS,
   PARENT_ITEM_ROW_ID,
   ROOT_ITEM_ROW_ID,
   CONTRACT_START_DATE,
   CONTRACT_END_DATE,
   LIST_PRICE,
   HARDWARE_ASSOCIATION_ID,
   EFFECTIVE_DATE
)
AS
SELECT * FROM TELS_RCRM_MV_LINE_ITEM;

CREATE OR REPLACE FORCE VIEW TELS_SUBMITTED_ORDERS_VIEW
(
   REC_TYPE,
   FILENAME,
   BATCHPROCESSDATE,
   RECORDNUMBER,
   IS_FILTERED,
   ORDER_NUMBER,
   BILLING_ACCOUNT,
   CUSTOMER_LAST_NAME,
   CUSTOMER_FIRST_NAME,
   ORDER_TYPE,
   ORDER_SUB_TYPE,
   CREATED_DATE,
   PARTNER_CODE,
   CAMPAIGN_NAME,
   CAMPAIGN_NUMBER,
   CAMPAIGN_TYPE,
   CHANNEL_TYPE,
   CAMPAIGN_START_DATE,
   BUSINESS_UNIT,
   SALES_FORCE_ID,
   CUSTOMER_ID,
   ORDER_REVISION_NUMBER,
   SUBMITTED_DATE,
   STATUS_HEADER,
   REASON_CODE,
   COMMISSION_TRANSACTION_TYPE,
   SOURCE_SYSTEM,
   ROW_ID,
   PRODUCT,
   PART_NUMBER,
   ACTION_CODE,
   TRANSFER_TYPE,
   EVENT_SOURCE,
   PROD_PROM_ID,
   PROVISIONED_DATE,
   NET_PRICE,
   COMMISSION_PRODUCT_TYPE,
   COMMISSIONABLE,
   STATUS_ORDER_LINE_ITEM,
   ORIGINAL_ORDER_NUMBER,
   HARDWARE_SUPPLIED_FLAG,
   SUB_ACTION_CODE,
   PROMOTION_INTEGRATION_ID,
   NGB_PROD_TYPE,
   PROMOTION_PART_NUMBER,
   PRODUCT_ID,
   O2A_STATUS,
   PARENT_ITEM_ROW_ID,
   ROOT_ITEM_ROW_ID,
   CONTRACT_START_DATE,
   CONTRACT_END_DATE,
   LIST_PRICE,
   HARDWARE_ASSOCIATION_ID,
   EFFECTIVE_DATE
)
AS
   WITH                                                 /*--- ROOT TYPES ---*/
       MOLI
        AS (  SELECT 'MOLI' REC_TYPE,
                     d.FILENAME,
                     d.BATCHPROCESSDATE,
                     MAX (d.RECORDNUMBER) RECORDNUMBER,
                     d.IS_FILTERED,
                     d.ORDER_NUMBER,
                     d.BILLING_ACCOUNT,
                     d.CUSTOMER_LAST_NAME,
                     d.CUSTOMER_FIRST_NAME,
                     d.ORDER_TYPE,
                     d.ORDER_SUB_TYPE,
                     d.CREATED_DATE,
                     d.PARTNER_CODE,
                     d.CAMPAIGN_NAME,
                     d.CAMPAIGN_NUMBER,
                     d.CAMPAIGN_TYPE,
                     d.CHANNEL_TYPE,
                     d.CAMPAIGN_START_DATE,
                     d.BUSINESS_UNIT,
                     d.SALES_FORCE_ID,
                     d.CUSTOMER_ID,
                     d.ORDER_REVISION_NUMBER,
                     d.SUBMITTED_DATE,
                     d.STATUS_HEADER,
                     d.REASON_CODE,
                     d.COMMISSION_TRANSACTION_TYPE,
                     d.SOURCE_SYSTEM,
                     d.ROW_ID,
                     d.PRODUCT,
                     d.PART_NUMBER,
                     d.ACTION_CODE,
                     d.TRANSFER_TYPE,
                     d.EVENT_SOURCE,
                     d.PROD_PROM_ID,
                     d.PROVISIONED_DATE,
                     d.NET_PRICE,
                     d.COMMISSION_PRODUCT_TYPE,
                     d.COMMISSIONABLE,
                     d.STATUS_ORDER_LINE_ITEM,
                     d.ORIGINAL_ORDER_NUMBER,
                     d.HARDWARE_SUPPLIED_FLAG,
                     d.SUB_ACTION_CODE,
                     d.PROMOTION_INTEGRATION_ID,
                     d.NGB_PROD_TYPE,
                     d.PROMOTION_PART_NUMBER,
                     d.PRODUCT_ID,
                     d.O2A_STATUS,
                     d.PARENT_ITEM_ROW_ID,
                     d.ROOT_ITEM_ROW_ID,
                     d.CONTRACT_START_DATE,
                     d.CONTRACT_END_DATE,
                     d.LIST_PRICE,
                     d.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN d.STATUS_HEADER IN ('Completed')
                        THEN
                           d.PROVISIONED_DATE
                        ELSE
                           d.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM TELS_STAGE_RCRM d
               WHERE d.ROOT_ITEM_ROW_ID = d.ROW_ID
                     AND NVL (d.ORDER_SUB_TYPE, 'NULL') <> 'Transfer'
            GROUP BY 'MOLI',
                     d.FILENAME,
                     d.BATCHPROCESSDATE,
                     d.IS_FILTERED,
                     d.ORDER_NUMBER,
                     d.BILLING_ACCOUNT,
                     d.CUSTOMER_LAST_NAME,
                     d.CUSTOMER_FIRST_NAME,
                     d.ORDER_TYPE,
                     d.ORDER_SUB_TYPE,
                     d.CREATED_DATE,
                     d.PARTNER_CODE,
                     d.CAMPAIGN_NAME,
                     d.CAMPAIGN_NUMBER,
                     d.CAMPAIGN_TYPE,
                     d.CHANNEL_TYPE,
                     d.CAMPAIGN_START_DATE,
                     d.BUSINESS_UNIT,
                     d.SALES_FORCE_ID,
                     d.CUSTOMER_ID,
                     d.ORDER_REVISION_NUMBER,
                     d.SUBMITTED_DATE,
                     d.STATUS_HEADER,
                     d.REASON_CODE,
                     d.COMMISSION_TRANSACTION_TYPE,
                     d.SOURCE_SYSTEM,
                     d.ROW_ID,
                     d.PRODUCT,
                     d.PART_NUMBER,
                     d.ACTION_CODE,
                     d.TRANSFER_TYPE,
                     d.EVENT_SOURCE,
                     d.PROD_PROM_ID,
                     d.PROVISIONED_DATE,
                     d.NET_PRICE,
                     d.COMMISSION_PRODUCT_TYPE,
                     d.COMMISSIONABLE,
                     d.STATUS_ORDER_LINE_ITEM,
                     d.ORIGINAL_ORDER_NUMBER,
                     d.HARDWARE_SUPPLIED_FLAG,
                     d.SUB_ACTION_CODE,
                     d.PROMOTION_INTEGRATION_ID,
                     d.NGB_PROD_TYPE,
                     d.PROMOTION_PART_NUMBER,
                     d.PRODUCT_ID,
                     d.O2A_STATUS,
                     d.PARENT_ITEM_ROW_ID,
                     d.ROOT_ITEM_ROW_ID,
                     d.CONTRACT_START_DATE,
                     d.CONTRACT_END_DATE,
                     d.LIST_PRICE,
                     d.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN d.STATUS_HEADER IN ('Completed')
                        THEN
                           d.PROVISIONED_DATE
                        ELSE
                           d.SUBMITTED_DATE
                     END),
        OLI
        AS (  SELECT 'OLI' REC_TYPE,
                     d.FILENAME,
                     d.BATCHPROCESSDATE,
                     MAX (d.RECORDNUMBER) RECORDNUMBER,
                     d.IS_FILTERED,
                     d.ORDER_NUMBER,
                     d.BILLING_ACCOUNT,
                     d.CUSTOMER_LAST_NAME,
                     d.CUSTOMER_FIRST_NAME,
                     d.ORDER_TYPE,
                     d.ORDER_SUB_TYPE,
                     d.CREATED_DATE,
                     d.PARTNER_CODE,
                     d.CAMPAIGN_NAME,
                     d.CAMPAIGN_NUMBER,
                     d.CAMPAIGN_TYPE,
                     d.CHANNEL_TYPE,
                     d.CAMPAIGN_START_DATE,
                     d.BUSINESS_UNIT,
                     d.SALES_FORCE_ID,
                     d.CUSTOMER_ID,
                     d.ORDER_REVISION_NUMBER,
                     d.SUBMITTED_DATE,
                     d.STATUS_HEADER,
                     d.REASON_CODE,
                     d.COMMISSION_TRANSACTION_TYPE,
                     d.SOURCE_SYSTEM,
                     d.ROW_ID,
                     d.PRODUCT,
                     d.PART_NUMBER,
                     d.ACTION_CODE,
                     d.TRANSFER_TYPE,
                     d.EVENT_SOURCE,
                     d.PROD_PROM_ID,
                     d.PROVISIONED_DATE,
                     d.NET_PRICE,
                     d.COMMISSION_PRODUCT_TYPE,
                     d.COMMISSIONABLE,
                     d.STATUS_ORDER_LINE_ITEM,
                     d.ORIGINAL_ORDER_NUMBER,
                     d.HARDWARE_SUPPLIED_FLAG,
                     d.SUB_ACTION_CODE,
                     d.PROMOTION_INTEGRATION_ID,
                     d.NGB_PROD_TYPE,
                     d.PROMOTION_PART_NUMBER,
                     d.PRODUCT_ID,
                     d.O2A_STATUS,
                     d.PARENT_ITEM_ROW_ID,
                     d.ROOT_ITEM_ROW_ID,
                     d.CONTRACT_START_DATE,
                     d.CONTRACT_END_DATE,
                     d.LIST_PRICE,
                     d.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN d.STATUS_HEADER IN ('Completed')
                        THEN
                           d.PROVISIONED_DATE
                        ELSE
                           d.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM TELS_STAGE_RCRM d
               WHERE d.ROOT_ITEM_ROW_ID != d.ROW_ID
                     AND NVL (d.ORDER_SUB_TYPE, 'NULL') <> 'Transfer'
            GROUP BY 'OLI',
                     d.FILENAME,
                     d.BATCHPROCESSDATE,
                     d.IS_FILTERED,
                     d.ORDER_NUMBER,
                     d.BILLING_ACCOUNT,
                     d.CUSTOMER_LAST_NAME,
                     d.CUSTOMER_FIRST_NAME,
                     d.ORDER_TYPE,
                     d.ORDER_SUB_TYPE,
                     d.CREATED_DATE,
                     d.PARTNER_CODE,
                     d.CAMPAIGN_NAME,
                     d.CAMPAIGN_NUMBER,
                     d.CAMPAIGN_TYPE,
                     d.CHANNEL_TYPE,
                     d.CAMPAIGN_START_DATE,
                     d.BUSINESS_UNIT,
                     d.SALES_FORCE_ID,
                     d.CUSTOMER_ID,
                     d.ORDER_REVISION_NUMBER,
                     d.SUBMITTED_DATE,
                     d.STATUS_HEADER,
                     d.REASON_CODE,
                     d.COMMISSION_TRANSACTION_TYPE,
                     d.SOURCE_SYSTEM,
                     d.ROW_ID,
                     d.PRODUCT,
                     d.PART_NUMBER,
                     d.ACTION_CODE,
                     d.TRANSFER_TYPE,
                     d.EVENT_SOURCE,
                     d.PROD_PROM_ID,
                     d.PROVISIONED_DATE,
                     d.NET_PRICE,
                     d.COMMISSION_PRODUCT_TYPE,
                     d.COMMISSIONABLE,
                     d.STATUS_ORDER_LINE_ITEM,
                     d.ORIGINAL_ORDER_NUMBER,
                     d.HARDWARE_SUPPLIED_FLAG,
                     d.SUB_ACTION_CODE,
                     d.PROMOTION_INTEGRATION_ID,
                     d.NGB_PROD_TYPE,
                     d.PROMOTION_PART_NUMBER,
                     d.PRODUCT_ID,
                     d.O2A_STATUS,
                     d.PARENT_ITEM_ROW_ID,
                     d.ROOT_ITEM_ROW_ID,
                     d.CONTRACT_START_DATE,
                     d.CONTRACT_END_DATE,
                     d.LIST_PRICE,
                     d.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN d.STATUS_HEADER IN ('Completed')
                        THEN
                           d.PROVISIONED_DATE
                        ELSE
                           d.SUBMITTED_DATE
                     END)                             /*--- SIMPLE TYPES ---*/
                         ,
        VAS_OLI
        AS (SELECT 'VAS_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE IN
                      ('Commissions VAS', 'Commissions Convert Plan')),
        DARO_MOLI
        AS (SELECT 'DARO_MOLI' REC_TYPE,
                   m.FILENAME,
                   m.BATCHPROCESSDATE,
                   m.RECORDNUMBER,
                   m.IS_FILTERED,
                   m.ORDER_NUMBER,
                   m.BILLING_ACCOUNT,
                   m.CUSTOMER_LAST_NAME,
                   m.CUSTOMER_FIRST_NAME,
                   m.ORDER_TYPE,
                   m.ORDER_SUB_TYPE,
                   m.CREATED_DATE,
                   m.PARTNER_CODE,
                   m.CAMPAIGN_NAME,
                   m.CAMPAIGN_NUMBER,
                   m.CAMPAIGN_TYPE,
                   m.CHANNEL_TYPE,
                   m.CAMPAIGN_START_DATE,
                   m.BUSINESS_UNIT,
                   m.SALES_FORCE_ID,
                   m.CUSTOMER_ID,
                   m.ORDER_REVISION_NUMBER,
                   m.SUBMITTED_DATE,
                   m.STATUS_HEADER,
                   m.REASON_CODE,
                   m.COMMISSION_TRANSACTION_TYPE,
                   m.SOURCE_SYSTEM,
                   m.ROW_ID,
                   m.PRODUCT,
                   m.PART_NUMBER,
                   m.ACTION_CODE,
                   m.TRANSFER_TYPE,
                   m.EVENT_SOURCE,
                   m.PROD_PROM_ID,
                   m.PROVISIONED_DATE,
                   m.NET_PRICE,
                   m.COMMISSION_PRODUCT_TYPE,
                   m.COMMISSIONABLE,
                   m.STATUS_ORDER_LINE_ITEM,
                   m.ORIGINAL_ORDER_NUMBER,
                   m.HARDWARE_SUPPLIED_FLAG,
                   m.SUB_ACTION_CODE,
                   m.PROMOTION_INTEGRATION_ID,
                   m.NGB_PROD_TYPE,
                   m.PROMOTION_PART_NUMBER,
                   m.PRODUCT_ID,
                   m.O2A_STATUS,
                   m.PARENT_ITEM_ROW_ID,
                   m.ROOT_ITEM_ROW_ID,
                   m.CONTRACT_START_DATE,
                   m.CONTRACT_END_DATE,
                   m.LIST_PRICE,
                   m.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN m.STATUS_HEADER IN ('Completed')
                      THEN
                         m.PROVISIONED_DATE
                      ELSE
                         m.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM MOLI m
             WHERE m.COMMISSION_PRODUCT_TYPE = 'Commissions DARO'),
        FHW_OLI
        AS (SELECT 'FHW_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Fixed Hardware'),
        MP_OLI
        AS (SELECT 'MP_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE IN
                      ('Commissions Main Plan',
                       'Commissions Standalone',
                       'Commissions Bundle')
                   AND o.ACTION_CODE = 'Add'),
        SIM_OLI
        AS (SELECT 'SIM_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions SIM'),
        HW_OLI
        AS (SELECT 'HW_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Hardware'
                   AND o.ACTION_CODE = 'Add'),
        FHW_OLI
        AS (SELECT 'FHW_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Fixed Hardware'),
        CONTRACT_OLI
        AS (SELECT 'CONTRACT_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Contract'),
        MAIN_CONTRACT_OLI
        AS (SELECT 'MAIN_CONTRACT_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Main Contract'),
        CONVERT_PLAN_OLI
        AS (SELECT 'CONVERT_PLAN_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Convert Plan'
                   AND o.ACTION_CODE IN ('Add')),
        ACCESS_TYPE_OLI
        AS (SELECT 'ACCESS_TYPE_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM OLI o
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Access Type'),
        SERVICE_MOLI
        AS (SELECT 'SERVICE_MOLI' REC_TYPE,
                   m.FILENAME,
                   m.BATCHPROCESSDATE,
                   m.RECORDNUMBER,
                   m.IS_FILTERED,
                   m.ORDER_NUMBER,
                   m.BILLING_ACCOUNT,
                   m.CUSTOMER_LAST_NAME,
                   m.CUSTOMER_FIRST_NAME,
                   m.ORDER_TYPE,
                   m.ORDER_SUB_TYPE,
                   m.CREATED_DATE,
                   m.PARTNER_CODE,
                   m.CAMPAIGN_NAME,
                   m.CAMPAIGN_NUMBER,
                   m.CAMPAIGN_TYPE,
                   m.CHANNEL_TYPE,
                   m.CAMPAIGN_START_DATE,
                   m.BUSINESS_UNIT,
                   m.SALES_FORCE_ID,
                   m.CUSTOMER_ID,
                   m.ORDER_REVISION_NUMBER,
                   m.SUBMITTED_DATE,
                   m.STATUS_HEADER,
                   m.REASON_CODE,
                   m.COMMISSION_TRANSACTION_TYPE,
                   m.SOURCE_SYSTEM,
                   m.ROW_ID,
                   m.PRODUCT,
                   m.PART_NUMBER,
                   m.ACTION_CODE,
                   m.TRANSFER_TYPE,
                   m.EVENT_SOURCE,
                   m.PROD_PROM_ID,
                   m.PROVISIONED_DATE,
                   m.NET_PRICE,
                   m.COMMISSION_PRODUCT_TYPE,
                   m.COMMISSIONABLE,
                   m.STATUS_ORDER_LINE_ITEM,
                   m.ORIGINAL_ORDER_NUMBER,
                   m.HARDWARE_SUPPLIED_FLAG,
                   m.SUB_ACTION_CODE,
                   m.PROMOTION_INTEGRATION_ID,
                   m.NGB_PROD_TYPE,
                   m.PROMOTION_PART_NUMBER,
                   m.PRODUCT_ID,
                   m.O2A_STATUS,
                   m.PARENT_ITEM_ROW_ID,
                   m.ROOT_ITEM_ROW_ID,
                   m.CONTRACT_START_DATE,
                   m.CONTRACT_END_DATE,
                   m.LIST_PRICE,
                   m.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN m.STATUS_HEADER IN ('Completed')
                      THEN
                         m.PROVISIONED_DATE
                      ELSE
                         m.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM MOLI m
             WHERE m.COMMISSION_PRODUCT_TYPE = 'Commissions Service'),
        MP_MOC_MOLI
        AS (SELECT 'MP_MOC_MOLI' REC_TYPE,
                   m.FILENAME,
                   m.BATCHPROCESSDATE,
                   m.RECORDNUMBER,
                   m.IS_FILTERED,
                   m.ORDER_NUMBER,
                   m.BILLING_ACCOUNT,
                   m.CUSTOMER_LAST_NAME,
                   m.CUSTOMER_FIRST_NAME,
                   m.ORDER_TYPE,
                   m.ORDER_SUB_TYPE,
                   m.CREATED_DATE,
                   m.PARTNER_CODE,
                   m.CAMPAIGN_NAME,
                   m.CAMPAIGN_NUMBER,
                   m.CAMPAIGN_TYPE,
                   m.CHANNEL_TYPE,
                   m.CAMPAIGN_START_DATE,
                   m.BUSINESS_UNIT,
                   m.SALES_FORCE_ID,
                   m.CUSTOMER_ID,
                   m.ORDER_REVISION_NUMBER,
                   m.SUBMITTED_DATE,
                   m.STATUS_HEADER,
                   m.REASON_CODE,
                   m.COMMISSION_TRANSACTION_TYPE,
                   m.SOURCE_SYSTEM,
                   m.ROW_ID,
                   m.PRODUCT,
                   m.PART_NUMBER,
                   m.ACTION_CODE,
                   m.TRANSFER_TYPE,
                   m.EVENT_SOURCE,
                   m.PROD_PROM_ID,
                   m.PROVISIONED_DATE,
                   m.NET_PRICE,
                   m.COMMISSION_PRODUCT_TYPE,
                   m.COMMISSIONABLE,
                   m.STATUS_ORDER_LINE_ITEM,
                   m.ORIGINAL_ORDER_NUMBER,
                   m.HARDWARE_SUPPLIED_FLAG,
                   m.SUB_ACTION_CODE,
                   m.PROMOTION_INTEGRATION_ID,
                   m.NGB_PROD_TYPE,
                   m.PROMOTION_PART_NUMBER,
                   m.PRODUCT_ID,
                   m.O2A_STATUS,
                   m.PARENT_ITEM_ROW_ID,
                   m.ROOT_ITEM_ROW_ID,
                   m.CONTRACT_START_DATE,
                   m.CONTRACT_END_DATE,
                   m.LIST_PRICE,
                   m.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN m.STATUS_HEADER IN ('Completed')
                      THEN
                         m.PROVISIONED_DATE
                      ELSE
                         m.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM MOLI m
             WHERE m.COMMISSION_PRODUCT_TYPE IN
                      ('Commissions Standalone', 'Commissions Bundle')
                   AND m.ACTION_CODE IN ('Add'))   /*--- COMPOSITE TYPES ---*/
                                                ,
        VAS_ASSOC_MOLI
        AS (  SELECT 'VAS_ASSOC_MOLI' REC_TYPE,
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM    MOLI m
                     JOIN
                        VAS_OLI o
                     ON     o.ROOT_ITEM_ROW_ID = m.ROW_ID
                        AND o.STATUS_HEADER = m.STATUS_HEADER
                        AND o.ORDER_NUMBER = m.ORDER_NUMBER
                        AND o.FILENAME = m.FILENAME
            GROUP BY 'VAS_ASSOC_MOLI',
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END),
        VAS_ASSOC_CONTRACT_OLI
        AS (SELECT 'VAS_ASSOC_CONTRACT_OLI' REC_TYPE,
                   co.FILENAME,
                   co.BATCHPROCESSDATE,
                   co.RECORDNUMBER,
                   co.IS_FILTERED,
                   co.ORDER_NUMBER,
                   co.BILLING_ACCOUNT,
                   co.CUSTOMER_LAST_NAME,
                   co.CUSTOMER_FIRST_NAME,
                   co.ORDER_TYPE,
                   co.ORDER_SUB_TYPE,
                   co.CREATED_DATE,
                   co.PARTNER_CODE,
                   co.CAMPAIGN_NAME,
                   co.CAMPAIGN_NUMBER,
                   co.CAMPAIGN_TYPE,
                   co.CHANNEL_TYPE,
                   co.CAMPAIGN_START_DATE,
                   co.BUSINESS_UNIT,
                   co.SALES_FORCE_ID,
                   co.CUSTOMER_ID,
                   co.ORDER_REVISION_NUMBER,
                   co.SUBMITTED_DATE,
                   co.STATUS_HEADER,
                   co.REASON_CODE,
                   co.COMMISSION_TRANSACTION_TYPE,
                   co.SOURCE_SYSTEM,
                   co.ROW_ID,
                   co.PRODUCT,
                   co.PART_NUMBER,
                   co.ACTION_CODE,
                   co.TRANSFER_TYPE,
                   co.EVENT_SOURCE,
                   co.PROD_PROM_ID,
                   co.PROVISIONED_DATE,
                   co.NET_PRICE,
                   co.COMMISSION_PRODUCT_TYPE,
                   co.COMMISSIONABLE,
                   co.STATUS_ORDER_LINE_ITEM,
                   co.ORIGINAL_ORDER_NUMBER,
                   co.HARDWARE_SUPPLIED_FLAG,
                   co.SUB_ACTION_CODE,
                   co.PROMOTION_INTEGRATION_ID,
                   co.NGB_PROD_TYPE,
                   co.PROMOTION_PART_NUMBER,
                   co.PRODUCT_ID,
                   co.O2A_STATUS,
                   co.PARENT_ITEM_ROW_ID,
                   co.ROOT_ITEM_ROW_ID,
                   co.CONTRACT_START_DATE,
                   co.CONTRACT_END_DATE,
                   co.LIST_PRICE,
                   co.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN co.STATUS_HEADER IN ('Completed')
                      THEN
                         co.PROVISIONED_DATE
                      ELSE
                         co.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    CONTRACT_OLI co
                   JOIN
                      VAS_OLI vo
                   ON     vo.ROOT_ITEM_ROW_ID = co.ROOT_ITEM_ROW_ID
                      AND vo.STATUS_HEADER = co.STATUS_HEADER
                      AND vo.ORDER_NUMBER = co.ORDER_NUMBER
                      AND vo.FILENAME = co.FILENAME
             WHERE co.COMMISSION_PRODUCT_TYPE = 'Commissions Contract'
                   AND co.ACTION_CODE IN ('Add', '-')
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = co.ROW_ID
                                      AND stg.FILENAME = co.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete')
                   AND EXISTS
                          (SELECT 1
                             FROM TELS_STAGE_RCRM stg
                            WHERE     stg.ROW_ID = co.ROW_ID
                                  AND stg.FILENAME = co.FILENAME
                                  AND stg.ATTRIBUTE_DISPLAY_NAME = 'Plan Id'
                                  AND stg.ATTRIBUTE_VALUE = vo.PART_NUMBER)),
        HW_ASSOC_CONTRACT_OLI
        AS (SELECT 'HW_ASSOC_CONTRACT_OLI' REC_TYPE,
                   co.FILENAME,
                   co.BATCHPROCESSDATE,
                   co.RECORDNUMBER,
                   co.IS_FILTERED,
                   co.ORDER_NUMBER,
                   co.BILLING_ACCOUNT,
                   co.CUSTOMER_LAST_NAME,
                   co.CUSTOMER_FIRST_NAME,
                   co.ORDER_TYPE,
                   co.ORDER_SUB_TYPE,
                   co.CREATED_DATE,
                   co.PARTNER_CODE,
                   co.CAMPAIGN_NAME,
                   co.CAMPAIGN_NUMBER,
                   co.CAMPAIGN_TYPE,
                   co.CHANNEL_TYPE,
                   co.CAMPAIGN_START_DATE,
                   co.BUSINESS_UNIT,
                   co.SALES_FORCE_ID,
                   co.CUSTOMER_ID,
                   co.ORDER_REVISION_NUMBER,
                   co.SUBMITTED_DATE,
                   co.STATUS_HEADER,
                   co.REASON_CODE,
                   co.COMMISSION_TRANSACTION_TYPE,
                   co.SOURCE_SYSTEM,
                   co.ROW_ID,
                   co.PRODUCT,
                   co.PART_NUMBER,
                   co.ACTION_CODE,
                   co.TRANSFER_TYPE,
                   co.EVENT_SOURCE,
                   co.PROD_PROM_ID,
                   co.PROVISIONED_DATE,
                   co.NET_PRICE,
                   co.COMMISSION_PRODUCT_TYPE,
                   co.COMMISSIONABLE,
                   co.STATUS_ORDER_LINE_ITEM,
                   co.ORIGINAL_ORDER_NUMBER,
                   co.HARDWARE_SUPPLIED_FLAG,
                   co.SUB_ACTION_CODE,
                   co.PROMOTION_INTEGRATION_ID,
                   co.NGB_PROD_TYPE,
                   co.PROMOTION_PART_NUMBER,
                   co.PRODUCT_ID,
                   co.O2A_STATUS,
                   co.PARENT_ITEM_ROW_ID,
                   co.ROOT_ITEM_ROW_ID,
                   co.CONTRACT_START_DATE,
                   co.CONTRACT_END_DATE,
                   co.LIST_PRICE,
                   co.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN co.STATUS_HEADER IN ('Completed')
                      THEN
                         co.PROVISIONED_DATE
                      ELSE
                         co.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    CONTRACT_OLI co
                   JOIN
                      HW_OLI ho
                   ON     ho.ROOT_ITEM_ROW_ID = co.ROOT_ITEM_ROW_ID
                      AND ho.STATUS_HEADER = co.STATUS_HEADER
                      AND ho.ORDER_NUMBER = co.ORDER_NUMBER
                      AND ho.FILENAME = co.FILENAME --AND co.ATTRIBUTE_VALUE = ho.PART_NUMBER
             WHERE co.ACTION_CODE IN ('Add', '-')
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = co.ROW_ID
                                      AND stg.FILENAME = co.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete')
                   AND EXISTS
                          (SELECT 1
                             FROM TELS_STAGE_RCRM stg
                            WHERE     stg.ROW_ID = co.ROW_ID
                                  AND stg.FILENAME = co.FILENAME
                                  AND stg.ATTRIBUTE_VALUE = ho.PART_NUMBER)),
        HW_ASSOC_PLAN_OLI
        AS (SELECT 'HW_ASSOC_PLAN_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    OLI o
                   JOIN
                      HW_OLI ho
                   ON     ho.ROOT_ITEM_ROW_ID = o.ROOT_ITEM_ROW_ID
                      AND ho.STATUS_HEADER = o.STATUS_HEADER
                      AND ho.ORDER_NUMBER = o.ORDER_NUMBER
                      AND ho.FILENAME = o.FILENAME
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions Main Plan'
                   AND o.ACTION_CODE IN ('Add', '-', 'Update')),
        HW_ASSOC_MRO_OLI
        AS (SELECT 'HW_ASSOC_MRO_OLI' REC_TYPE,
                   o.FILENAME,
                   o.BATCHPROCESSDATE,
                   o.RECORDNUMBER,
                   o.IS_FILTERED,
                   o.ORDER_NUMBER,
                   o.BILLING_ACCOUNT,
                   o.CUSTOMER_LAST_NAME,
                   o.CUSTOMER_FIRST_NAME,
                   o.ORDER_TYPE,
                   o.ORDER_SUB_TYPE,
                   o.CREATED_DATE,
                   o.PARTNER_CODE,
                   o.CAMPAIGN_NAME,
                   o.CAMPAIGN_NUMBER,
                   o.CAMPAIGN_TYPE,
                   o.CHANNEL_TYPE,
                   o.CAMPAIGN_START_DATE,
                   o.BUSINESS_UNIT,
                   o.SALES_FORCE_ID,
                   o.CUSTOMER_ID,
                   o.ORDER_REVISION_NUMBER,
                   o.SUBMITTED_DATE,
                   o.STATUS_HEADER,
                   o.REASON_CODE,
                   o.COMMISSION_TRANSACTION_TYPE,
                   o.SOURCE_SYSTEM,
                   o.ROW_ID,
                   o.PRODUCT,
                   o.PART_NUMBER,
                   o.ACTION_CODE,
                   o.TRANSFER_TYPE,
                   o.EVENT_SOURCE,
                   o.PROD_PROM_ID,
                   o.PROVISIONED_DATE,
                   o.NET_PRICE,
                   o.COMMISSION_PRODUCT_TYPE,
                   o.COMMISSIONABLE,
                   o.STATUS_ORDER_LINE_ITEM,
                   o.ORIGINAL_ORDER_NUMBER,
                   o.HARDWARE_SUPPLIED_FLAG,
                   o.SUB_ACTION_CODE,
                   o.PROMOTION_INTEGRATION_ID,
                   o.NGB_PROD_TYPE,
                   o.PROMOTION_PART_NUMBER,
                   o.PRODUCT_ID,
                   o.O2A_STATUS,
                   o.PARENT_ITEM_ROW_ID,
                   o.ROOT_ITEM_ROW_ID,
                   o.CONTRACT_START_DATE,
                   o.CONTRACT_END_DATE,
                   o.LIST_PRICE,
                   o.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN o.STATUS_HEADER IN ('Completed')
                      THEN
                         o.PROVISIONED_DATE
                      ELSE
                         o.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    OLI o
                   JOIN
                      HW_OLI ho
                   ON     ho.ROOT_ITEM_ROW_ID = o.ROOT_ITEM_ROW_ID
                      AND ho.STATUS_HEADER = o.STATUS_HEADER
                      AND ho.ORDER_NUMBER = o.ORDER_NUMBER
                      AND ho.PARENT_ITEM_ROW_ID = o.ROW_ID
                      AND ho.FILENAME = o.FILENAME
             WHERE o.COMMISSION_PRODUCT_TYPE = 'Commissions MRO'),
        FHW_ASSOC_MOLI
        AS (  SELECT 'FHW_ASSOC_MOLI' REC_TYPE,
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM    MOLI m
                     JOIN
                        FHW_OLI o
                     ON     o.ROOT_ITEM_ROW_ID = m.ROW_ID
                        AND o.STATUS_HEADER = m.STATUS_HEADER
                        AND o.ORDER_NUMBER = m.ORDER_NUMBER
                        AND o.FILENAME = m.FILENAME
            GROUP BY 'FHW_ASSOC_MOLI',
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END),
        HW_ASSOC_MOLI
        AS (  SELECT 'HW_ASSOC_MOLI' REC_TYPE,
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM    MOLI m
                     JOIN
                        HW_OLI o
                     ON     o.ROOT_ITEM_ROW_ID = m.ROW_ID
                        AND o.STATUS_HEADER = m.STATUS_HEADER
                        AND o.ORDER_NUMBER = m.ORDER_NUMBER
                        AND o.FILENAME = m.FILENAME
            GROUP BY 'HW_ASSOC_MOLI',
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END),
        MP_ASSOC_MOLI
        AS (  SELECT 'MP_ASSOC_MOLI' REC_TYPE,
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM    MOLI m
                     JOIN
                        MP_OLI o
                     ON     o.ROOT_ITEM_ROW_ID = m.ROW_ID
                        AND o.STATUS_HEADER = m.STATUS_HEADER
                        AND o.ORDER_NUMBER = m.ORDER_NUMBER
                        AND o.FILENAME = m.FILENAME
            GROUP BY 'MP_ASSOC_MOLI',
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END),
        FHW_ASSOC_VAS_OLI
        AS (SELECT 'FHW_ASSOC_VAS_OLI' REC_TYPE,
                   vo.FILENAME,
                   vo.BATCHPROCESSDATE,
                   vo.RECORDNUMBER,
                   vo.IS_FILTERED,
                   vo.ORDER_NUMBER,
                   vo.BILLING_ACCOUNT,
                   vo.CUSTOMER_LAST_NAME,
                   vo.CUSTOMER_FIRST_NAME,
                   vo.ORDER_TYPE,
                   vo.ORDER_SUB_TYPE,
                   vo.CREATED_DATE,
                   vo.PARTNER_CODE,
                   vo.CAMPAIGN_NAME,
                   vo.CAMPAIGN_NUMBER,
                   vo.CAMPAIGN_TYPE,
                   vo.CHANNEL_TYPE,
                   vo.CAMPAIGN_START_DATE,
                   vo.BUSINESS_UNIT,
                   vo.SALES_FORCE_ID,
                   vo.CUSTOMER_ID,
                   vo.ORDER_REVISION_NUMBER,
                   vo.SUBMITTED_DATE,
                   vo.STATUS_HEADER,
                   vo.REASON_CODE,
                   vo.COMMISSION_TRANSACTION_TYPE,
                   vo.SOURCE_SYSTEM,
                   vo.ROW_ID,
                   vo.PRODUCT,
                   vo.PART_NUMBER,
                   vo.ACTION_CODE,
                   vo.TRANSFER_TYPE,
                   vo.EVENT_SOURCE,
                   vo.PROD_PROM_ID,
                   vo.PROVISIONED_DATE,
                   vo.NET_PRICE,
                   vo.COMMISSION_PRODUCT_TYPE,
                   vo.COMMISSIONABLE,
                   vo.STATUS_ORDER_LINE_ITEM,
                   vo.ORIGINAL_ORDER_NUMBER,
                   vo.HARDWARE_SUPPLIED_FLAG,
                   vo.SUB_ACTION_CODE,
                   vo.PROMOTION_INTEGRATION_ID,
                   vo.NGB_PROD_TYPE,
                   vo.PROMOTION_PART_NUMBER,
                   vo.PRODUCT_ID,
                   vo.O2A_STATUS,
                   vo.PARENT_ITEM_ROW_ID,
                   vo.ROOT_ITEM_ROW_ID,
                   vo.CONTRACT_START_DATE,
                   vo.CONTRACT_END_DATE,
                   vo.LIST_PRICE,
                   vo.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN vo.STATUS_HEADER IN ('Completed')
                      THEN
                         vo.PROVISIONED_DATE
                      ELSE
                         vo.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    VAS_OLI vo
                   JOIN
                      FHW_OLI fo
                   ON     fo.ROOT_ITEM_ROW_ID = vo.ROOT_ITEM_ROW_ID
                      AND fo.STATUS_HEADER = vo.STATUS_HEADER
                      AND fo.ORDER_NUMBER = vo.ORDER_NUMBER
                      AND fo.PROMOTION_INTEGRATION_ID =
                             vo.PROMOTION_INTEGRATION_ID
                      AND fo.FILENAME = vo.FILENAME),
        VAS_ASSOC_FHW_OLI
        AS (SELECT 'VAS_ASSOC_FHW_OLI' REC_TYPE,
                   fo.FILENAME,
                   fo.BATCHPROCESSDATE,
                   fo.RECORDNUMBER,
                   fo.IS_FILTERED,
                   fo.ORDER_NUMBER,
                   fo.BILLING_ACCOUNT,
                   fo.CUSTOMER_LAST_NAME,
                   fo.CUSTOMER_FIRST_NAME,
                   fo.ORDER_TYPE,
                   fo.ORDER_SUB_TYPE,
                   fo.CREATED_DATE,
                   fo.PARTNER_CODE,
                   fo.CAMPAIGN_NAME,
                   fo.CAMPAIGN_NUMBER,
                   fo.CAMPAIGN_TYPE,
                   fo.CHANNEL_TYPE,
                   fo.CAMPAIGN_START_DATE,
                   fo.BUSINESS_UNIT,
                   fo.SALES_FORCE_ID,
                   fo.CUSTOMER_ID,
                   fo.ORDER_REVISION_NUMBER,
                   fo.SUBMITTED_DATE,
                   fo.STATUS_HEADER,
                   fo.REASON_CODE,
                   fo.COMMISSION_TRANSACTION_TYPE,
                   fo.SOURCE_SYSTEM,
                   fo.ROW_ID,
                   fo.PRODUCT,
                   fo.PART_NUMBER,
                   fo.ACTION_CODE,
                   fo.TRANSFER_TYPE,
                   fo.EVENT_SOURCE,
                   fo.PROD_PROM_ID,
                   fo.PROVISIONED_DATE,
                   fo.NET_PRICE,
                   fo.COMMISSION_PRODUCT_TYPE,
                   fo.COMMISSIONABLE,
                   fo.STATUS_ORDER_LINE_ITEM,
                   fo.ORIGINAL_ORDER_NUMBER,
                   fo.HARDWARE_SUPPLIED_FLAG,
                   fo.SUB_ACTION_CODE,
                   fo.PROMOTION_INTEGRATION_ID,
                   fo.NGB_PROD_TYPE,
                   fo.PROMOTION_PART_NUMBER,
                   fo.PRODUCT_ID,
                   fo.O2A_STATUS,
                   fo.PARENT_ITEM_ROW_ID,
                   fo.ROOT_ITEM_ROW_ID,
                   fo.CONTRACT_START_DATE,
                   fo.CONTRACT_END_DATE,
                   fo.LIST_PRICE,
                   fo.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN fo.STATUS_HEADER IN ('Completed')
                      THEN
                         fo.PROVISIONED_DATE
                      ELSE
                         fo.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    FHW_OLI fo
                   JOIN
                      VAS_OLI vo
                   ON     vo.ROOT_ITEM_ROW_ID = fo.ROOT_ITEM_ROW_ID
                      AND vo.STATUS_HEADER = fo.STATUS_HEADER
                      AND vo.ORDER_NUMBER = fo.ORDER_NUMBER
                      AND vo.PROMOTION_INTEGRATION_ID =
                             fo.PROMOTION_INTEGRATION_ID
                      AND fo.FILENAME = vo.FILENAME),
        VAS_ASSOC_OFFER_MOLI
        AS (  SELECT 'VAS_ASSOC_OFFER_MOLI' REC_TYPE,
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END
                        EFFECTIVE_DATE
                FROM    MOLI m
                     JOIN
                        VAS_ASSOC_MOLI o
                     ON o.STATUS_HEADER = m.STATUS_HEADER
                        AND o.ORDER_NUMBER = m.ORDER_NUMBER
                        AND o.PROMOTION_INTEGRATION_ID =
                               m.PROMOTION_INTEGRATION_ID
                        AND o.FILENAME = m.FILENAME
               WHERE m.COMMISSION_PRODUCT_TYPE IN
                        ('Commissions Bundle', 'Commissions Standalone')
            GROUP BY 'VAS_ASSOC_OFFER_MOLI',
                     m.FILENAME,
                     m.BATCHPROCESSDATE,
                     m.RECORDNUMBER,
                     m.IS_FILTERED,
                     m.ORDER_NUMBER,
                     m.BILLING_ACCOUNT,
                     m.CUSTOMER_LAST_NAME,
                     m.CUSTOMER_FIRST_NAME,
                     m.ORDER_TYPE,
                     m.ORDER_SUB_TYPE,
                     m.CREATED_DATE,
                     m.PARTNER_CODE,
                     m.CAMPAIGN_NAME,
                     m.CAMPAIGN_NUMBER,
                     m.CAMPAIGN_TYPE,
                     m.CHANNEL_TYPE,
                     m.CAMPAIGN_START_DATE,
                     m.BUSINESS_UNIT,
                     m.SALES_FORCE_ID,
                     m.CUSTOMER_ID,
                     m.ORDER_REVISION_NUMBER,
                     m.SUBMITTED_DATE,
                     m.STATUS_HEADER,
                     m.REASON_CODE,
                     m.COMMISSION_TRANSACTION_TYPE,
                     m.SOURCE_SYSTEM,
                     m.ROW_ID,
                     m.PRODUCT,
                     m.PART_NUMBER,
                     m.ACTION_CODE,
                     m.TRANSFER_TYPE,
                     m.EVENT_SOURCE,
                     m.PROD_PROM_ID,
                     m.PROVISIONED_DATE,
                     m.NET_PRICE,
                     m.COMMISSION_PRODUCT_TYPE,
                     m.COMMISSIONABLE,
                     m.STATUS_ORDER_LINE_ITEM,
                     m.ORIGINAL_ORDER_NUMBER,
                     m.HARDWARE_SUPPLIED_FLAG,
                     m.SUB_ACTION_CODE,
                     m.PROMOTION_INTEGRATION_ID,
                     m.NGB_PROD_TYPE,
                     m.PROMOTION_PART_NUMBER,
                     m.PRODUCT_ID,
                     m.O2A_STATUS,
                     m.PARENT_ITEM_ROW_ID,
                     m.ROOT_ITEM_ROW_ID,
                     m.CONTRACT_START_DATE,
                     m.CONTRACT_END_DATE,
                     m.LIST_PRICE,
                     m.HARDWARE_ASSOCIATION_ID,
                     CASE
                        WHEN m.STATUS_HEADER IN ('Completed')
                        THEN
                           m.PROVISIONED_DATE
                        ELSE
                           m.SUBMITTED_DATE
                     END),
        MP_ASSOC_CONVERT_PLAN_OLI
        AS (SELECT 'MP_ASSOC_CONVERT_PLAN_OLI' REC_TYPE,
                   cpo.FILENAME,
                   cpo.BATCHPROCESSDATE,
                   cpo.RECORDNUMBER,
                   cpo.IS_FILTERED,
                   cpo.ORDER_NUMBER,
                   cpo.BILLING_ACCOUNT,
                   cpo.CUSTOMER_LAST_NAME,
                   cpo.CUSTOMER_FIRST_NAME,
                   cpo.ORDER_TYPE,
                   cpo.ORDER_SUB_TYPE,
                   cpo.CREATED_DATE,
                   cpo.PARTNER_CODE,
                   cpo.CAMPAIGN_NAME,
                   cpo.CAMPAIGN_NUMBER,
                   cpo.CAMPAIGN_TYPE,
                   cpo.CHANNEL_TYPE,
                   cpo.CAMPAIGN_START_DATE,
                   cpo.BUSINESS_UNIT,
                   cpo.SALES_FORCE_ID,
                   cpo.CUSTOMER_ID,
                   cpo.ORDER_REVISION_NUMBER,
                   cpo.SUBMITTED_DATE,
                   cpo.STATUS_HEADER,
                   cpo.REASON_CODE,
                   cpo.COMMISSION_TRANSACTION_TYPE,
                   cpo.SOURCE_SYSTEM,
                   cpo.ROW_ID,
                   cpo.PRODUCT,
                   cpo.PART_NUMBER,
                   cpo.ACTION_CODE,
                   cpo.TRANSFER_TYPE,
                   cpo.EVENT_SOURCE,
                   cpo.PROD_PROM_ID,
                   cpo.PROVISIONED_DATE,
                   cpo.NET_PRICE,
                   cpo.COMMISSION_PRODUCT_TYPE,
                   cpo.COMMISSIONABLE,
                   cpo.STATUS_ORDER_LINE_ITEM,
                   cpo.ORIGINAL_ORDER_NUMBER,
                   cpo.HARDWARE_SUPPLIED_FLAG,
                   cpo.SUB_ACTION_CODE,
                   cpo.PROMOTION_INTEGRATION_ID,
                   cpo.NGB_PROD_TYPE,
                   cpo.PROMOTION_PART_NUMBER,
                   cpo.PRODUCT_ID,
                   cpo.O2A_STATUS,
                   cpo.PARENT_ITEM_ROW_ID,
                   cpo.ROOT_ITEM_ROW_ID,
                   cpo.CONTRACT_START_DATE,
                   cpo.CONTRACT_END_DATE,
                   cpo.LIST_PRICE,
                   cpo.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN cpo.STATUS_HEADER IN ('Completed')
                      THEN
                         cpo.PROVISIONED_DATE
                      ELSE
                         cpo.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    CONVERT_PLAN_OLI cpo
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = cpo.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = cpo.STATUS_HEADER
                      AND mo.ORDER_NUMBER = cpo.ORDER_NUMBER
                      AND mo.FILENAME = cpo.FILENAME
             WHERE cpo.ORDER_TYPE IN ('Add New Service', 'Modify')),
        MP_ASSOC_SIM_OLI
        AS (SELECT 'MP_ASSOC_SIM_OLI' REC_TYPE,
                   so.FILENAME,
                   so.BATCHPROCESSDATE,
                   so.RECORDNUMBER,
                   so.IS_FILTERED,
                   so.ORDER_NUMBER,
                   so.BILLING_ACCOUNT,
                   so.CUSTOMER_LAST_NAME,
                   so.CUSTOMER_FIRST_NAME,
                   so.ORDER_TYPE,
                   so.ORDER_SUB_TYPE,
                   so.CREATED_DATE,
                   so.PARTNER_CODE,
                   so.CAMPAIGN_NAME,
                   so.CAMPAIGN_NUMBER,
                   so.CAMPAIGN_TYPE,
                   so.CHANNEL_TYPE,
                   so.CAMPAIGN_START_DATE,
                   so.BUSINESS_UNIT,
                   so.SALES_FORCE_ID,
                   so.CUSTOMER_ID,
                   so.ORDER_REVISION_NUMBER,
                   so.SUBMITTED_DATE,
                   so.STATUS_HEADER,
                   so.REASON_CODE,
                   so.COMMISSION_TRANSACTION_TYPE,
                   so.SOURCE_SYSTEM,
                   so.ROW_ID,
                   so.PRODUCT,
                   so.PART_NUMBER,
                   so.ACTION_CODE,
                   so.TRANSFER_TYPE,
                   so.EVENT_SOURCE,
                   so.PROD_PROM_ID,
                   so.PROVISIONED_DATE,
                   so.NET_PRICE,
                   so.COMMISSION_PRODUCT_TYPE,
                   so.COMMISSIONABLE,
                   so.STATUS_ORDER_LINE_ITEM,
                   so.ORIGINAL_ORDER_NUMBER,
                   so.HARDWARE_SUPPLIED_FLAG,
                   so.SUB_ACTION_CODE,
                   so.PROMOTION_INTEGRATION_ID,
                   so.NGB_PROD_TYPE,
                   so.PROMOTION_PART_NUMBER,
                   so.PRODUCT_ID,
                   so.O2A_STATUS,
                   so.PARENT_ITEM_ROW_ID,
                   so.ROOT_ITEM_ROW_ID,
                   so.CONTRACT_START_DATE,
                   so.CONTRACT_END_DATE,
                   so.LIST_PRICE,
                   so.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN so.STATUS_HEADER IN ('Completed')
                      THEN
                         so.PROVISIONED_DATE
                      ELSE
                         so.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    SIM_OLI so
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = so.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = so.STATUS_HEADER
                      AND mo.ORDER_NUMBER = so.ORDER_NUMBER
                      AND mo.FILENAME = so.FILENAME
             WHERE so.ACTION_CODE <> 'Delete'
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = so.ROW_ID
                                      AND stg.FILENAME = so.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete')),
        MP_ASSOC_MAIN_CONT_ADD_OLI
        AS (SELECT 'MP_ASSOC_MAIN_CONT_ADD_OLI' REC_TYPE,
                   mco.FILENAME,
                   mco.BATCHPROCESSDATE,
                   mco.RECORDNUMBER,
                   mco.IS_FILTERED,
                   mco.ORDER_NUMBER,
                   mco.BILLING_ACCOUNT,
                   mco.CUSTOMER_LAST_NAME,
                   mco.CUSTOMER_FIRST_NAME,
                   mco.ORDER_TYPE,
                   mco.ORDER_SUB_TYPE,
                   mco.CREATED_DATE,
                   mco.PARTNER_CODE,
                   mco.CAMPAIGN_NAME,
                   mco.CAMPAIGN_NUMBER,
                   mco.CAMPAIGN_TYPE,
                   mco.CHANNEL_TYPE,
                   mco.CAMPAIGN_START_DATE,
                   mco.BUSINESS_UNIT,
                   mco.SALES_FORCE_ID,
                   mco.CUSTOMER_ID,
                   mco.ORDER_REVISION_NUMBER,
                   mco.SUBMITTED_DATE,
                   mco.STATUS_HEADER,
                   mco.REASON_CODE,
                   mco.COMMISSION_TRANSACTION_TYPE,
                   mco.SOURCE_SYSTEM,
                   mco.ROW_ID,
                   mco.PRODUCT,
                   mco.PART_NUMBER,
                   mco.ACTION_CODE,
                   mco.TRANSFER_TYPE,
                   mco.EVENT_SOURCE,
                   mco.PROD_PROM_ID,
                   mco.PROVISIONED_DATE,
                   mco.NET_PRICE,
                   mco.COMMISSION_PRODUCT_TYPE,
                   mco.COMMISSIONABLE,
                   mco.STATUS_ORDER_LINE_ITEM,
                   mco.ORIGINAL_ORDER_NUMBER,
                   mco.HARDWARE_SUPPLIED_FLAG,
                   mco.SUB_ACTION_CODE,
                   mco.PROMOTION_INTEGRATION_ID,
                   mco.NGB_PROD_TYPE,
                   mco.PROMOTION_PART_NUMBER,
                   mco.PRODUCT_ID,
                   mco.O2A_STATUS,
                   mco.PARENT_ITEM_ROW_ID,
                   mco.ROOT_ITEM_ROW_ID,
                   mco.CONTRACT_START_DATE,
                   mco.CONTRACT_END_DATE,
                   mco.LIST_PRICE,
                   mco.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN mco.STATUS_HEADER IN ('Completed')
                      THEN
                         mco.PROVISIONED_DATE
                      ELSE
                         mco.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    MAIN_CONTRACT_OLI mco
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = mco.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = mco.STATUS_HEADER
                      AND mo.ORDER_NUMBER = mco.ORDER_NUMBER
                      AND mo.FILENAME = mco.FILENAME
             WHERE mco.ACTION_CODE IN ('Add', '-')
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = mco.ROW_ID
                                      AND stg.FILENAME = mco.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete')),
        MP_ASSOC_MAIN_CONT_DEL_OLI
        AS (SELECT 'MP_ASSOC_MAIN_CONT_ADD_OLI' REC_TYPE,
                   mco.FILENAME,
                   mco.BATCHPROCESSDATE,
                   mco.RECORDNUMBER,
                   mco.IS_FILTERED,
                   mco.ORDER_NUMBER,
                   mco.BILLING_ACCOUNT,
                   mco.CUSTOMER_LAST_NAME,
                   mco.CUSTOMER_FIRST_NAME,
                   mco.ORDER_TYPE,
                   mco.ORDER_SUB_TYPE,
                   mco.CREATED_DATE,
                   mco.PARTNER_CODE,
                   mco.CAMPAIGN_NAME,
                   mco.CAMPAIGN_NUMBER,
                   mco.CAMPAIGN_TYPE,
                   mco.CHANNEL_TYPE,
                   mco.CAMPAIGN_START_DATE,
                   mco.BUSINESS_UNIT,
                   mco.SALES_FORCE_ID,
                   mco.CUSTOMER_ID,
                   mco.ORDER_REVISION_NUMBER,
                   mco.SUBMITTED_DATE,
                   mco.STATUS_HEADER,
                   mco.REASON_CODE,
                   mco.COMMISSION_TRANSACTION_TYPE,
                   mco.SOURCE_SYSTEM,
                   mco.ROW_ID,
                   mco.PRODUCT,
                   mco.PART_NUMBER,
                   mco.ACTION_CODE,
                   mco.TRANSFER_TYPE,
                   mco.EVENT_SOURCE,
                   mco.PROD_PROM_ID,
                   mco.PROVISIONED_DATE,
                   mco.NET_PRICE,
                   mco.COMMISSION_PRODUCT_TYPE,
                   mco.COMMISSIONABLE,
                   mco.STATUS_ORDER_LINE_ITEM,
                   mco.ORIGINAL_ORDER_NUMBER,
                   mco.HARDWARE_SUPPLIED_FLAG,
                   mco.SUB_ACTION_CODE,
                   mco.PROMOTION_INTEGRATION_ID,
                   mco.NGB_PROD_TYPE,
                   mco.PROMOTION_PART_NUMBER,
                   mco.PRODUCT_ID,
                   mco.O2A_STATUS,
                   mco.PARENT_ITEM_ROW_ID,
                   mco.ROOT_ITEM_ROW_ID,
                   mco.CONTRACT_START_DATE,
                   mco.CONTRACT_END_DATE,
                   mco.LIST_PRICE,
                   mco.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN mco.STATUS_HEADER IN ('Completed')
                      THEN
                         mco.PROVISIONED_DATE
                      ELSE
                         mco.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    MAIN_CONTRACT_OLI mco
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = mco.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = mco.STATUS_HEADER
                      AND mo.ORDER_NUMBER = mco.ORDER_NUMBER
                      AND mo.FILENAME = mco.FILENAME
             WHERE mco.ACTION_CODE = 'Delete'
                   AND EXISTS
                          (SELECT 1
                             FROM TELS_STAGE_RCRM stg
                            WHERE     stg.ROW_ID = mco.ROW_ID
                                  AND stg.FILENAME = mco.FILENAME
                                  AND stg.ATTRIBUTE_ACTION_CODE = 'Delete')),
        MP_MOC_ASSOC_MAIN_CON_ADD_OLI
        AS (SELECT 'MP_MOC_ASSOC_MAIN_CON_ADD_OLI' REC_TYPE,
                   mco.FILENAME,
                   mco.BATCHPROCESSDATE,
                   mco.RECORDNUMBER,
                   mco.IS_FILTERED,
                   mco.ORDER_NUMBER,
                   mco.BILLING_ACCOUNT,
                   mco.CUSTOMER_LAST_NAME,
                   mco.CUSTOMER_FIRST_NAME,
                   mco.ORDER_TYPE,
                   mco.ORDER_SUB_TYPE,
                   mco.CREATED_DATE,
                   mco.PARTNER_CODE,
                   mco.CAMPAIGN_NAME,
                   mco.CAMPAIGN_NUMBER,
                   mco.CAMPAIGN_TYPE,
                   mco.CHANNEL_TYPE,
                   mco.CAMPAIGN_START_DATE,
                   mco.BUSINESS_UNIT,
                   mco.SALES_FORCE_ID,
                   mco.CUSTOMER_ID,
                   mco.ORDER_REVISION_NUMBER,
                   mco.SUBMITTED_DATE,
                   mco.STATUS_HEADER,
                   mco.REASON_CODE,
                   mco.COMMISSION_TRANSACTION_TYPE,
                   mco.SOURCE_SYSTEM,
                   mco.ROW_ID,
                   mco.PRODUCT,
                   mco.PART_NUMBER,
                   mco.ACTION_CODE,
                   mco.TRANSFER_TYPE,
                   mco.EVENT_SOURCE,
                   mco.PROD_PROM_ID,
                   mco.PROVISIONED_DATE,
                   mco.NET_PRICE,
                   mco.COMMISSION_PRODUCT_TYPE,
                   mco.COMMISSIONABLE,
                   mco.STATUS_ORDER_LINE_ITEM,
                   mco.ORIGINAL_ORDER_NUMBER,
                   mco.HARDWARE_SUPPLIED_FLAG,
                   mco.SUB_ACTION_CODE,
                   mco.PROMOTION_INTEGRATION_ID,
                   mco.NGB_PROD_TYPE,
                   mco.PROMOTION_PART_NUMBER,
                   mco.PRODUCT_ID,
                   mco.O2A_STATUS,
                   mco.PARENT_ITEM_ROW_ID,
                   mco.ROOT_ITEM_ROW_ID,
                   mco.CONTRACT_START_DATE,
                   mco.CONTRACT_END_DATE,
                   mco.LIST_PRICE,
                   mco.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN mco.STATUS_HEADER IN ('Completed')
                      THEN
                         mco.PROVISIONED_DATE
                      ELSE
                         mco.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    MAIN_CONTRACT_OLI mco
                   JOIN
                      MP_MOC_MOLI mmo
                   ON mmo.PROMOTION_INTEGRATION_ID =
                         mco.PROMOTION_INTEGRATION_ID
                      AND mmo.STATUS_HEADER = mco.STATUS_HEADER
                      AND mmo.ORDER_NUMBER = mco.ORDER_NUMBER
                      AND mmo.FILENAME = mco.FILENAME
             WHERE mco.ACTION_CODE IN ('Add', '-')
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = mco.ROW_ID
                                      AND stg.FILENAME = mco.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete')),
        MP_MOC_ASSOC_MAIN_CON_DEL_OLI
        AS (SELECT 'MP_MOC_ASSOC_MAIN_CON_DEL_OLI' REC_TYPE,
                   mco.FILENAME,
                   mco.BATCHPROCESSDATE,
                   mco.RECORDNUMBER,
                   mco.IS_FILTERED,
                   mco.ORDER_NUMBER,
                   mco.BILLING_ACCOUNT,
                   mco.CUSTOMER_LAST_NAME,
                   mco.CUSTOMER_FIRST_NAME,
                   mco.ORDER_TYPE,
                   mco.ORDER_SUB_TYPE,
                   mco.CREATED_DATE,
                   mco.PARTNER_CODE,
                   mco.CAMPAIGN_NAME,
                   mco.CAMPAIGN_NUMBER,
                   mco.CAMPAIGN_TYPE,
                   mco.CHANNEL_TYPE,
                   mco.CAMPAIGN_START_DATE,
                   mco.BUSINESS_UNIT,
                   mco.SALES_FORCE_ID,
                   mco.CUSTOMER_ID,
                   mco.ORDER_REVISION_NUMBER,
                   mco.SUBMITTED_DATE,
                   mco.STATUS_HEADER,
                   mco.REASON_CODE,
                   mco.COMMISSION_TRANSACTION_TYPE,
                   mco.SOURCE_SYSTEM,
                   mco.ROW_ID,
                   mco.PRODUCT,
                   mco.PART_NUMBER,
                   mco.ACTION_CODE,
                   mco.TRANSFER_TYPE,
                   mco.EVENT_SOURCE,
                   mco.PROD_PROM_ID,
                   mco.PROVISIONED_DATE,
                   mco.NET_PRICE,
                   mco.COMMISSION_PRODUCT_TYPE,
                   mco.COMMISSIONABLE,
                   mco.STATUS_ORDER_LINE_ITEM,
                   mco.ORIGINAL_ORDER_NUMBER,
                   mco.HARDWARE_SUPPLIED_FLAG,
                   mco.SUB_ACTION_CODE,
                   mco.PROMOTION_INTEGRATION_ID,
                   mco.NGB_PROD_TYPE,
                   mco.PROMOTION_PART_NUMBER,
                   mco.PRODUCT_ID,
                   mco.O2A_STATUS,
                   mco.PARENT_ITEM_ROW_ID,
                   mco.ROOT_ITEM_ROW_ID,
                   mco.CONTRACT_START_DATE,
                   mco.CONTRACT_END_DATE,
                   mco.LIST_PRICE,
                   mco.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN mco.STATUS_HEADER IN ('Completed')
                      THEN
                         mco.PROVISIONED_DATE
                      ELSE
                         mco.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    MAIN_CONTRACT_OLI mco
                   JOIN
                      MP_MOC_MOLI mmo
                   ON mmo.PROMOTION_INTEGRATION_ID =
                         mco.PROMOTION_INTEGRATION_ID
                      AND mmo.STATUS_HEADER = mco.STATUS_HEADER
                      AND mmo.ORDER_NUMBER = mco.ORDER_NUMBER
                      AND mmo.FILENAME = mco.FILENAME
             WHERE mco.ACTION_CODE IN ('Add', '-')
                   AND EXISTS
                          (SELECT 1
                             FROM TELS_STAGE_RCRM stg
                            WHERE     stg.ROW_ID = mco.ROW_ID
                                  AND stg.FILENAME = mco.FILENAME
                                  AND stg.ATTRIBUTE_ACTION_CODE = 'Delete')),
        MP_ASSOC_MAIN_PLAN_DEL_OLI
        AS (SELECT 'MP_ASSOC_MAIN_PLAN_DEL_OLI' REC_TYPE,
                   mo1.FILENAME,
                   mo1.BATCHPROCESSDATE,
                   mo1.RECORDNUMBER,
                   mo1.IS_FILTERED,
                   mo1.ORDER_NUMBER,
                   mo1.BILLING_ACCOUNT,
                   mo1.CUSTOMER_LAST_NAME,
                   mo1.CUSTOMER_FIRST_NAME,
                   mo1.ORDER_TYPE,
                   mo1.ORDER_SUB_TYPE,
                   mo1.CREATED_DATE,
                   mo1.PARTNER_CODE,
                   mo1.CAMPAIGN_NAME,
                   mo1.CAMPAIGN_NUMBER,
                   mo1.CAMPAIGN_TYPE,
                   mo1.CHANNEL_TYPE,
                   mo1.CAMPAIGN_START_DATE,
                   mo1.BUSINESS_UNIT,
                   mo1.SALES_FORCE_ID,
                   mo1.CUSTOMER_ID,
                   mo1.ORDER_REVISION_NUMBER,
                   mo1.SUBMITTED_DATE,
                   mo1.STATUS_HEADER,
                   mo1.REASON_CODE,
                   mo1.COMMISSION_TRANSACTION_TYPE,
                   mo1.SOURCE_SYSTEM,
                   mo1.ROW_ID,
                   mo1.PRODUCT,
                   mo1.PART_NUMBER,
                   mo1.ACTION_CODE,
                   mo1.TRANSFER_TYPE,
                   mo1.EVENT_SOURCE,
                   mo1.PROD_PROM_ID,
                   mo1.PROVISIONED_DATE,
                   mo1.NET_PRICE,
                   mo1.COMMISSION_PRODUCT_TYPE,
                   mo1.COMMISSIONABLE,
                   mo1.STATUS_ORDER_LINE_ITEM,
                   mo1.ORIGINAL_ORDER_NUMBER,
                   mo1.HARDWARE_SUPPLIED_FLAG,
                   mo1.SUB_ACTION_CODE,
                   mo1.PROMOTION_INTEGRATION_ID,
                   mo1.NGB_PROD_TYPE,
                   mo1.PROMOTION_PART_NUMBER,
                   mo1.PRODUCT_ID,
                   mo1.O2A_STATUS,
                   mo1.PARENT_ITEM_ROW_ID,
                   mo1.ROOT_ITEM_ROW_ID,
                   mo1.CONTRACT_START_DATE,
                   mo1.CONTRACT_END_DATE,
                   mo1.LIST_PRICE,
                   mo1.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN mo1.STATUS_HEADER IN ('Completed')
                      THEN
                         mo1.PROVISIONED_DATE
                      ELSE
                         mo1.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    MP_OLI mo1
                   JOIN
                      MP_OLI mo2
                   ON     mo2.ROOT_ITEM_ROW_ID = mo1.ROOT_ITEM_ROW_ID
                      AND mo2.STATUS_HEADER = mo1.STATUS_HEADER
                      AND mo2.ORDER_NUMBER = mo1.ORDER_NUMBER
                      AND mo2.FILENAME = mo1.FILENAME
             WHERE mo1.ACTION_CODE = 'Delete'
                   AND EXISTS
                          (SELECT 1
                             FROM TELS_STAGE_RCRM stg
                            WHERE     stg.ROW_ID = mo1.ROW_ID
                                  AND stg.FILENAME = mo1.FILENAME
                                  AND stg.ATTRIBUTE_ACTION_CODE = 'Delete')),
        MP_ASSOC_CONTRACT_ADD_OLI
        AS (SELECT 'MP_ASSOC_CONTRACT_ADD_OLI' REC_TYPE,
                   co.FILENAME,
                   co.BATCHPROCESSDATE,
                   co.RECORDNUMBER,
                   co.IS_FILTERED,
                   co.ORDER_NUMBER,
                   co.BILLING_ACCOUNT,
                   co.CUSTOMER_LAST_NAME,
                   co.CUSTOMER_FIRST_NAME,
                   co.ORDER_TYPE,
                   co.ORDER_SUB_TYPE,
                   co.CREATED_DATE,
                   co.PARTNER_CODE,
                   co.CAMPAIGN_NAME,
                   co.CAMPAIGN_NUMBER,
                   co.CAMPAIGN_TYPE,
                   co.CHANNEL_TYPE,
                   co.CAMPAIGN_START_DATE,
                   co.BUSINESS_UNIT,
                   co.SALES_FORCE_ID,
                   co.CUSTOMER_ID,
                   co.ORDER_REVISION_NUMBER,
                   co.SUBMITTED_DATE,
                   co.STATUS_HEADER,
                   co.REASON_CODE,
                   co.COMMISSION_TRANSACTION_TYPE,
                   co.SOURCE_SYSTEM,
                   co.ROW_ID,
                   co.PRODUCT,
                   co.PART_NUMBER,
                   co.ACTION_CODE,
                   co.TRANSFER_TYPE,
                   co.EVENT_SOURCE,
                   co.PROD_PROM_ID,
                   co.PROVISIONED_DATE,
                   co.NET_PRICE,
                   co.COMMISSION_PRODUCT_TYPE,
                   co.COMMISSIONABLE,
                   co.STATUS_ORDER_LINE_ITEM,
                   co.ORIGINAL_ORDER_NUMBER,
                   co.HARDWARE_SUPPLIED_FLAG,
                   co.SUB_ACTION_CODE,
                   co.PROMOTION_INTEGRATION_ID,
                   co.NGB_PROD_TYPE,
                   co.PROMOTION_PART_NUMBER,
                   co.PRODUCT_ID,
                   co.O2A_STATUS,
                   co.PARENT_ITEM_ROW_ID,
                   co.ROOT_ITEM_ROW_ID,
                   co.CONTRACT_START_DATE,
                   co.CONTRACT_END_DATE,
                   co.LIST_PRICE,
                   co.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN co.STATUS_HEADER IN ('Completed')
                      THEN
                         co.PROVISIONED_DATE
                      ELSE
                         co.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    CONTRACT_OLI co
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = co.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = co.STATUS_HEADER
                      AND mo.ORDER_NUMBER = co.ORDER_NUMBER
                      AND mo.FILENAME = co.FILENAME
             WHERE co.ACTION_CODE IN ('Add', '-')
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = co.ROW_ID
                                      AND stg.FILENAME = co.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete')),
        MP_ASSOC_CONTRACT_DEL_OLI
        AS (SELECT 'MP_ASSOC_CONTRACT_DEL_OLI' REC_TYPE,
                   co.FILENAME,
                   co.BATCHPROCESSDATE,
                   co.RECORDNUMBER,
                   co.IS_FILTERED,
                   co.ORDER_NUMBER,
                   co.BILLING_ACCOUNT,
                   co.CUSTOMER_LAST_NAME,
                   co.CUSTOMER_FIRST_NAME,
                   co.ORDER_TYPE,
                   co.ORDER_SUB_TYPE,
                   co.CREATED_DATE,
                   co.PARTNER_CODE,
                   co.CAMPAIGN_NAME,
                   co.CAMPAIGN_NUMBER,
                   co.CAMPAIGN_TYPE,
                   co.CHANNEL_TYPE,
                   co.CAMPAIGN_START_DATE,
                   co.BUSINESS_UNIT,
                   co.SALES_FORCE_ID,
                   co.CUSTOMER_ID,
                   co.ORDER_REVISION_NUMBER,
                   co.SUBMITTED_DATE,
                   co.STATUS_HEADER,
                   co.REASON_CODE,
                   co.COMMISSION_TRANSACTION_TYPE,
                   co.SOURCE_SYSTEM,
                   co.ROW_ID,
                   co.PRODUCT,
                   co.PART_NUMBER,
                   co.ACTION_CODE,
                   co.TRANSFER_TYPE,
                   co.EVENT_SOURCE,
                   co.PROD_PROM_ID,
                   co.PROVISIONED_DATE,
                   co.NET_PRICE,
                   co.COMMISSION_PRODUCT_TYPE,
                   co.COMMISSIONABLE,
                   co.STATUS_ORDER_LINE_ITEM,
                   co.ORIGINAL_ORDER_NUMBER,
                   co.HARDWARE_SUPPLIED_FLAG,
                   co.SUB_ACTION_CODE,
                   co.PROMOTION_INTEGRATION_ID,
                   co.NGB_PROD_TYPE,
                   co.PROMOTION_PART_NUMBER,
                   co.PRODUCT_ID,
                   co.O2A_STATUS,
                   co.PARENT_ITEM_ROW_ID,
                   co.ROOT_ITEM_ROW_ID,
                   co.CONTRACT_START_DATE,
                   co.CONTRACT_END_DATE,
                   co.LIST_PRICE,
                   co.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN co.STATUS_HEADER IN ('Completed')
                      THEN
                         co.PROVISIONED_DATE
                      ELSE
                         co.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    CONTRACT_OLI co
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = co.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = co.STATUS_HEADER
                      AND mo.ORDER_NUMBER = co.ORDER_NUMBER
                      AND mo.FILENAME = co.FILENAME
             WHERE co.ACTION_CODE = 'Delete'
                   AND EXISTS
                          (SELECT 1
                             FROM TELS_STAGE_RCRM stg
                            WHERE     stg.ROW_ID = co.ROW_ID
                                  AND stg.FILENAME = co.FILENAME
                                  AND stg.ATTRIBUTE_ACTION_CODE = 'Delete')),
        MP_ASSOC_HW_OLI
        AS (SELECT 'MP_ASSOC_HW_OLI' REC_TYPE,
                   ho.FILENAME,
                   ho.BATCHPROCESSDATE,
                   ho.RECORDNUMBER,
                   ho.IS_FILTERED,
                   ho.ORDER_NUMBER,
                   ho.BILLING_ACCOUNT,
                   ho.CUSTOMER_LAST_NAME,
                   ho.CUSTOMER_FIRST_NAME,
                   ho.ORDER_TYPE,
                   ho.ORDER_SUB_TYPE,
                   ho.CREATED_DATE,
                   ho.PARTNER_CODE,
                   ho.CAMPAIGN_NAME,
                   ho.CAMPAIGN_NUMBER,
                   ho.CAMPAIGN_TYPE,
                   ho.CHANNEL_TYPE,
                   ho.CAMPAIGN_START_DATE,
                   ho.BUSINESS_UNIT,
                   ho.SALES_FORCE_ID,
                   ho.CUSTOMER_ID,
                   ho.ORDER_REVISION_NUMBER,
                   ho.SUBMITTED_DATE,
                   ho.STATUS_HEADER,
                   ho.REASON_CODE,
                   ho.COMMISSION_TRANSACTION_TYPE,
                   ho.SOURCE_SYSTEM,
                   ho.ROW_ID,
                   ho.PRODUCT,
                   ho.PART_NUMBER,
                   ho.ACTION_CODE,
                   ho.TRANSFER_TYPE,
                   ho.EVENT_SOURCE,
                   ho.PROD_PROM_ID,
                   ho.PROVISIONED_DATE,
                   ho.NET_PRICE,
                   ho.COMMISSION_PRODUCT_TYPE,
                   ho.COMMISSIONABLE,
                   ho.STATUS_ORDER_LINE_ITEM,
                   ho.ORIGINAL_ORDER_NUMBER,
                   ho.HARDWARE_SUPPLIED_FLAG,
                   ho.SUB_ACTION_CODE,
                   ho.PROMOTION_INTEGRATION_ID,
                   ho.NGB_PROD_TYPE,
                   ho.PROMOTION_PART_NUMBER,
                   ho.PRODUCT_ID,
                   ho.O2A_STATUS,
                   ho.PARENT_ITEM_ROW_ID,
                   ho.ROOT_ITEM_ROW_ID,
                   ho.CONTRACT_START_DATE,
                   ho.CONTRACT_END_DATE,
                   ho.LIST_PRICE,
                   ho.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN ho.STATUS_HEADER IN ('Completed')
                      THEN
                         ho.PROVISIONED_DATE
                      ELSE
                         ho.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    HW_OLI ho
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = ho.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = ho.STATUS_HEADER
                      AND mo.ORDER_NUMBER = ho.ORDER_NUMBER
                      AND mo.FILENAME = ho.FILENAME),
        MP_ASSOC_FHW_OLI
        AS (SELECT 'MP_ASSOC_FHW_OLI' REC_TYPE,
                   fo.FILENAME,
                   fo.BATCHPROCESSDATE,
                   fo.RECORDNUMBER,
                   fo.IS_FILTERED,
                   fo.ORDER_NUMBER,
                   fo.BILLING_ACCOUNT,
                   fo.CUSTOMER_LAST_NAME,
                   fo.CUSTOMER_FIRST_NAME,
                   fo.ORDER_TYPE,
                   fo.ORDER_SUB_TYPE,
                   fo.CREATED_DATE,
                   fo.PARTNER_CODE,
                   fo.CAMPAIGN_NAME,
                   fo.CAMPAIGN_NUMBER,
                   fo.CAMPAIGN_TYPE,
                   fo.CHANNEL_TYPE,
                   fo.CAMPAIGN_START_DATE,
                   fo.BUSINESS_UNIT,
                   fo.SALES_FORCE_ID,
                   fo.CUSTOMER_ID,
                   fo.ORDER_REVISION_NUMBER,
                   fo.SUBMITTED_DATE,
                   fo.STATUS_HEADER,
                   fo.REASON_CODE,
                   fo.COMMISSION_TRANSACTION_TYPE,
                   fo.SOURCE_SYSTEM,
                   fo.ROW_ID,
                   fo.PRODUCT,
                   fo.PART_NUMBER,
                   fo.ACTION_CODE,
                   fo.TRANSFER_TYPE,
                   fo.EVENT_SOURCE,
                   fo.PROD_PROM_ID,
                   fo.PROVISIONED_DATE,
                   fo.NET_PRICE,
                   fo.COMMISSION_PRODUCT_TYPE,
                   fo.COMMISSIONABLE,
                   fo.STATUS_ORDER_LINE_ITEM,
                   fo.ORIGINAL_ORDER_NUMBER,
                   fo.HARDWARE_SUPPLIED_FLAG,
                   fo.SUB_ACTION_CODE,
                   fo.PROMOTION_INTEGRATION_ID,
                   fo.NGB_PROD_TYPE,
                   fo.PROMOTION_PART_NUMBER,
                   fo.PRODUCT_ID,
                   fo.O2A_STATUS,
                   fo.PARENT_ITEM_ROW_ID,
                   fo.ROOT_ITEM_ROW_ID,
                   fo.CONTRACT_START_DATE,
                   fo.CONTRACT_END_DATE,
                   fo.LIST_PRICE,
                   fo.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN fo.STATUS_HEADER IN ('Completed')
                      THEN
                         fo.PROVISIONED_DATE
                      ELSE
                         fo.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    FHW_OLI fo
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = fo.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = fo.STATUS_HEADER
                      AND mo.ORDER_NUMBER = fo.ORDER_NUMBER
                      AND mo.PROMOTION_INTEGRATION_ID =
                             fo.PROMOTION_INTEGRATION_ID
                      AND mo.FILENAME = fo.FILENAME),
        MP_ASSOC_SERVICE_MOLI
        AS (SELECT 'MP_ASSOC_SERVICE_MOLI' REC_TYPE,
                   sm.FILENAME,
                   sm.BATCHPROCESSDATE,
                   sm.RECORDNUMBER,
                   sm.IS_FILTERED,
                   sm.ORDER_NUMBER,
                   sm.BILLING_ACCOUNT,
                   sm.CUSTOMER_LAST_NAME,
                   sm.CUSTOMER_FIRST_NAME,
                   sm.ORDER_TYPE,
                   sm.ORDER_SUB_TYPE,
                   sm.CREATED_DATE,
                   sm.PARTNER_CODE,
                   sm.CAMPAIGN_NAME,
                   sm.CAMPAIGN_NUMBER,
                   sm.CAMPAIGN_TYPE,
                   sm.CHANNEL_TYPE,
                   sm.CAMPAIGN_START_DATE,
                   sm.BUSINESS_UNIT,
                   sm.SALES_FORCE_ID,
                   sm.CUSTOMER_ID,
                   sm.ORDER_REVISION_NUMBER,
                   sm.SUBMITTED_DATE,
                   sm.STATUS_HEADER,
                   sm.REASON_CODE,
                   sm.COMMISSION_TRANSACTION_TYPE,
                   sm.SOURCE_SYSTEM,
                   sm.ROW_ID,
                   sm.PRODUCT,
                   sm.PART_NUMBER,
                   sm.ACTION_CODE,
                   sm.TRANSFER_TYPE,
                   sm.EVENT_SOURCE,
                   sm.PROD_PROM_ID,
                   sm.PROVISIONED_DATE,
                   sm.NET_PRICE,
                   sm.COMMISSION_PRODUCT_TYPE,
                   sm.COMMISSIONABLE,
                   sm.STATUS_ORDER_LINE_ITEM,
                   sm.ORIGINAL_ORDER_NUMBER,
                   sm.HARDWARE_SUPPLIED_FLAG,
                   sm.SUB_ACTION_CODE,
                   sm.PROMOTION_INTEGRATION_ID,
                   sm.NGB_PROD_TYPE,
                   sm.PROMOTION_PART_NUMBER,
                   sm.PRODUCT_ID,
                   sm.O2A_STATUS,
                   sm.PARENT_ITEM_ROW_ID,
                   sm.ROOT_ITEM_ROW_ID,
                   sm.CONTRACT_START_DATE,
                   sm.CONTRACT_END_DATE,
                   sm.LIST_PRICE,
                   sm.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN sm.STATUS_HEADER IN ('Completed')
                      THEN
                         sm.PROVISIONED_DATE
                      ELSE
                         sm.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    SERVICE_MOLI sm
                   JOIN
                      MP_OLI mo
                   ON     mo.ROOT_ITEM_ROW_ID = sm.ROOT_ITEM_ROW_ID
                      AND mo.STATUS_HEADER = sm.STATUS_HEADER
                      AND mo.ORDER_NUMBER = sm.ORDER_NUMBER
                      AND mo.PROMOTION_INTEGRATION_ID =
                             sm.PROMOTION_INTEGRATION_ID
                      AND mo.FILENAME = sm.FILENAME),
        MP_MOC_ASSOC_SERVICE_MOLI
        AS (SELECT 'MP_MOC_ASSOC_SERVICE_MOLI' REC_TYPE,
                   sm.FILENAME,
                   sm.BATCHPROCESSDATE,
                   sm.RECORDNUMBER,
                   sm.IS_FILTERED,
                   sm.ORDER_NUMBER,
                   sm.BILLING_ACCOUNT,
                   sm.CUSTOMER_LAST_NAME,
                   sm.CUSTOMER_FIRST_NAME,
                   sm.ORDER_TYPE,
                   sm.ORDER_SUB_TYPE,
                   sm.CREATED_DATE,
                   sm.PARTNER_CODE,
                   sm.CAMPAIGN_NAME,
                   sm.CAMPAIGN_NUMBER,
                   sm.CAMPAIGN_TYPE,
                   sm.CHANNEL_TYPE,
                   sm.CAMPAIGN_START_DATE,
                   sm.BUSINESS_UNIT,
                   sm.SALES_FORCE_ID,
                   sm.CUSTOMER_ID,
                   sm.ORDER_REVISION_NUMBER,
                   sm.SUBMITTED_DATE,
                   sm.STATUS_HEADER,
                   sm.REASON_CODE,
                   sm.COMMISSION_TRANSACTION_TYPE,
                   sm.SOURCE_SYSTEM,
                   sm.ROW_ID,
                   sm.PRODUCT,
                   sm.PART_NUMBER,
                   sm.ACTION_CODE,
                   sm.TRANSFER_TYPE,
                   sm.EVENT_SOURCE,
                   sm.PROD_PROM_ID,
                   sm.PROVISIONED_DATE,
                   sm.NET_PRICE,
                   sm.COMMISSION_PRODUCT_TYPE,
                   sm.COMMISSIONABLE,
                   sm.STATUS_ORDER_LINE_ITEM,
                   sm.ORIGINAL_ORDER_NUMBER,
                   sm.HARDWARE_SUPPLIED_FLAG,
                   sm.SUB_ACTION_CODE,
                   sm.PROMOTION_INTEGRATION_ID,
                   sm.NGB_PROD_TYPE,
                   sm.PROMOTION_PART_NUMBER,
                   sm.PRODUCT_ID,
                   sm.O2A_STATUS,
                   sm.PARENT_ITEM_ROW_ID,
                   sm.ROOT_ITEM_ROW_ID,
                   sm.CONTRACT_START_DATE,
                   sm.CONTRACT_END_DATE,
                   sm.LIST_PRICE,
                   sm.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN sm.STATUS_HEADER IN ('Completed')
                      THEN
                         sm.PROVISIONED_DATE
                      ELSE
                         sm.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    SERVICE_MOLI sm
                   JOIN
                      MP_MOC_MOLI mmo
                   ON     mmo.ROOT_ITEM_ROW_ID = sm.ROOT_ITEM_ROW_ID
                      AND mmo.STATUS_HEADER = sm.STATUS_HEADER
                      AND mmo.ORDER_NUMBER = sm.ORDER_NUMBER
                      AND mmo.PROMOTION_INTEGRATION_ID =
                             sm.PROMOTION_INTEGRATION_ID
                      AND mmo.FILENAME = sm.FILENAME),
        MP_MOC_ASSOC_SERVICE_MOLI
        AS (SELECT 'MP_MOC_ASSOC_SERVICE_MOLI' REC_TYPE,
                   sm.FILENAME,
                   sm.BATCHPROCESSDATE,
                   sm.RECORDNUMBER,
                   sm.IS_FILTERED,
                   sm.ORDER_NUMBER,
                   sm.BILLING_ACCOUNT,
                   sm.CUSTOMER_LAST_NAME,
                   sm.CUSTOMER_FIRST_NAME,
                   sm.ORDER_TYPE,
                   sm.ORDER_SUB_TYPE,
                   sm.CREATED_DATE,
                   sm.PARTNER_CODE,
                   sm.CAMPAIGN_NAME,
                   sm.CAMPAIGN_NUMBER,
                   sm.CAMPAIGN_TYPE,
                   sm.CHANNEL_TYPE,
                   sm.CAMPAIGN_START_DATE,
                   sm.BUSINESS_UNIT,
                   sm.SALES_FORCE_ID,
                   sm.CUSTOMER_ID,
                   sm.ORDER_REVISION_NUMBER,
                   sm.SUBMITTED_DATE,
                   sm.STATUS_HEADER,
                   sm.REASON_CODE,
                   sm.COMMISSION_TRANSACTION_TYPE,
                   sm.SOURCE_SYSTEM,
                   sm.ROW_ID,
                   sm.PRODUCT,
                   sm.PART_NUMBER,
                   sm.ACTION_CODE,
                   sm.TRANSFER_TYPE,
                   sm.EVENT_SOURCE,
                   sm.PROD_PROM_ID,
                   sm.PROVISIONED_DATE,
                   sm.NET_PRICE,
                   sm.COMMISSION_PRODUCT_TYPE,
                   sm.COMMISSIONABLE,
                   sm.STATUS_ORDER_LINE_ITEM,
                   sm.ORIGINAL_ORDER_NUMBER,
                   sm.HARDWARE_SUPPLIED_FLAG,
                   sm.SUB_ACTION_CODE,
                   sm.PROMOTION_INTEGRATION_ID,
                   sm.NGB_PROD_TYPE,
                   sm.PROMOTION_PART_NUMBER,
                   sm.PRODUCT_ID,
                   sm.O2A_STATUS,
                   sm.PARENT_ITEM_ROW_ID,
                   sm.ROOT_ITEM_ROW_ID,
                   sm.CONTRACT_START_DATE,
                   sm.CONTRACT_END_DATE,
                   sm.LIST_PRICE,
                   sm.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN sm.STATUS_HEADER IN ('Completed')
                      THEN
                         sm.PROVISIONED_DATE
                      ELSE
                         sm.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    SERVICE_MOLI sm
                   JOIN
                      MP_MOC_MOLI mmc
                   ON mmc.PROMOTION_INTEGRATION_ID =
                         sm.PROMOTION_INTEGRATION_ID
                      AND mmc.STATUS_HEADER = sm.STATUS_HEADER
                      AND mmc.ORDER_NUMBER = sm.ORDER_NUMBER
                      AND mmc.FILENAME = sm.FILENAME --    WHERE sm.ACTION_CODE = 'Delete'
                                                    --      AND EXISTS(SELECT 1 FROM TELS_STAGE_RCRM stg WHERE stg.RECORDNUMBER = sm.RECORDNUMBER AND stg.FILENAME = sm.FILENAME AND stg.ATTRIBUTE_ACTION_CODE = 'Delete')
           ),
        SERVICE_ASSOC_ACCESS_TYPE_OLI
        AS (SELECT 'SERVICE_ASSOC_ACCESS_TYPE_OLI' REC_TYPE,
                   ato.FILENAME,
                   ato.BATCHPROCESSDATE,
                   ato.RECORDNUMBER,
                   ato.IS_FILTERED,
                   ato.ORDER_NUMBER,
                   ato.BILLING_ACCOUNT,
                   ato.CUSTOMER_LAST_NAME,
                   ato.CUSTOMER_FIRST_NAME,
                   ato.ORDER_TYPE,
                   ato.ORDER_SUB_TYPE,
                   ato.CREATED_DATE,
                   ato.PARTNER_CODE,
                   ato.CAMPAIGN_NAME,
                   ato.CAMPAIGN_NUMBER,
                   ato.CAMPAIGN_TYPE,
                   ato.CHANNEL_TYPE,
                   ato.CAMPAIGN_START_DATE,
                   ato.BUSINESS_UNIT,
                   ato.SALES_FORCE_ID,
                   ato.CUSTOMER_ID,
                   ato.ORDER_REVISION_NUMBER,
                   ato.SUBMITTED_DATE,
                   ato.STATUS_HEADER,
                   ato.REASON_CODE,
                   ato.COMMISSION_TRANSACTION_TYPE,
                   ato.SOURCE_SYSTEM,
                   ato.ROW_ID,
                   ato.PRODUCT,
                   ato.PART_NUMBER,
                   ato.ACTION_CODE,
                   ato.TRANSFER_TYPE,
                   ato.EVENT_SOURCE,
                   ato.PROD_PROM_ID,
                   ato.PROVISIONED_DATE,
                   ato.NET_PRICE,
                   ato.COMMISSION_PRODUCT_TYPE,
                   ato.COMMISSIONABLE,
                   ato.STATUS_ORDER_LINE_ITEM,
                   ato.ORIGINAL_ORDER_NUMBER,
                   ato.HARDWARE_SUPPLIED_FLAG,
                   ato.SUB_ACTION_CODE,
                   ato.PROMOTION_INTEGRATION_ID,
                   ato.NGB_PROD_TYPE,
                   ato.PROMOTION_PART_NUMBER,
                   ato.PRODUCT_ID,
                   ato.O2A_STATUS,
                   ato.PARENT_ITEM_ROW_ID,
                   ato.ROOT_ITEM_ROW_ID,
                   ato.CONTRACT_START_DATE,
                   ato.CONTRACT_END_DATE,
                   ato.LIST_PRICE,
                   ato.HARDWARE_ASSOCIATION_ID,
                   CASE
                      WHEN ato.STATUS_HEADER IN ('Completed')
                      THEN
                         ato.PROVISIONED_DATE
                      ELSE
                         ato.SUBMITTED_DATE
                   END
                      EFFECTIVE_DATE
              FROM    ACCESS_TYPE_OLI ato
                   JOIN
                      SERVICE_MOLI sm
                   ON     sm.ROOT_ITEM_ROW_ID = ato.ROOT_ITEM_ROW_ID
                      AND sm.STATUS_HEADER = ato.STATUS_HEADER
                      AND sm.ORDER_NUMBER = ato.ORDER_NUMBER
                      AND sm.FILENAME = ato.FILENAME
             WHERE ato.ACTION_CODE IN ('Add', '-')
                   AND NOT EXISTS
                              (SELECT 1
                                 FROM TELS_STAGE_RCRM stg
                                WHERE stg.ROW_ID = ato.ROW_ID
                                      AND stg.FILENAME = ato.FILENAME
                                      AND stg.ATTRIBUTE_ACTION_CODE =
                                             'Delete'))
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM ACCESS_TYPE_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM CONTRACT_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM CONVERT_PLAN_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM DARO_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM FHW_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM HW_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_MOC_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM SIM_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM VAS_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM FHW_ASSOC_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM FHW_ASSOC_VAS_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM HW_ASSOC_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM HW_ASSOC_CONTRACT_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM HW_ASSOC_PLAN_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM HW_ASSOC_MRO_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MAIN_CONTRACT_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_CONTRACT_ADD_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_CONTRACT_DEL_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_CONVERT_PLAN_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_FHW_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_HW_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_SIM_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_MAIN_CONT_ADD_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_MAIN_CONT_DEL_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_MAIN_PLAN_DEL_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_ASSOC_SERVICE_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_MOC_ASSOC_SERVICE_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_MOC_ASSOC_MAIN_CON_ADD_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_MOC_ASSOC_MAIN_CON_DEL_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM MP_MOC_ASSOC_SERVICE_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM SERVICE_ASSOC_ACCESS_TYPE_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM SERVICE_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM VAS_ASSOC_MOLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM VAS_ASSOC_CONTRACT_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM VAS_ASSOC_FHW_OLI
   UNION ALL
   SELECT "REC_TYPE",
          "FILENAME",
          "BATCHPROCESSDATE",
          "RECORDNUMBER",
          "IS_FILTERED",
          "ORDER_NUMBER",
          "BILLING_ACCOUNT",
          "CUSTOMER_LAST_NAME",
          "CUSTOMER_FIRST_NAME",
          "ORDER_TYPE",
          "ORDER_SUB_TYPE",
          "CREATED_DATE",
          "PARTNER_CODE",
          "CAMPAIGN_NAME",
          "CAMPAIGN_NUMBER",
          "CAMPAIGN_TYPE",
          "CHANNEL_TYPE",
          "CAMPAIGN_START_DATE",
          "BUSINESS_UNIT",
          "SALES_FORCE_ID",
          "CUSTOMER_ID",
          "ORDER_REVISION_NUMBER",
          "SUBMITTED_DATE",
          "STATUS_HEADER",
          "REASON_CODE",
          "COMMISSION_TRANSACTION_TYPE",
          "SOURCE_SYSTEM",
          "ROW_ID",
          "PRODUCT",
          "PART_NUMBER",
          "ACTION_CODE",
          "TRANSFER_TYPE",
          "EVENT_SOURCE",
          "PROD_PROM_ID",
          "PROVISIONED_DATE",
          "NET_PRICE",
          "COMMISSION_PRODUCT_TYPE",
          "COMMISSIONABLE",
          "STATUS_ORDER_LINE_ITEM",
          "ORIGINAL_ORDER_NUMBER",
          "HARDWARE_SUPPLIED_FLAG",
          "SUB_ACTION_CODE",
          "PROMOTION_INTEGRATION_ID",
          "NGB_PROD_TYPE",
          "PROMOTION_PART_NUMBER",
          "PRODUCT_ID",
          "O2A_STATUS",
          "PARENT_ITEM_ROW_ID",
          "ROOT_ITEM_ROW_ID",
          "CONTRACT_START_DATE",
          "CONTRACT_END_DATE",
          "LIST_PRICE",
          "HARDWARE_ASSOCIATION_ID",
          "EFFECTIVE_DATE"
     FROM VAS_ASSOC_OFFER_MOLI;
